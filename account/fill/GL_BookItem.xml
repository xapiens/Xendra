<?xml version="1.0" encoding="UTF-8"?>
<stream>
  <record level="2" name="GL_BookItem">
    <table name="GL_BookItem" accesslevel="0" level="1" Identifier="a207a3ca-e08a-45a2-ba5d-2bc933436326">
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="a207a3ca-e08a-45a2-ba5d-2bc933436326" IsParent="false" Name="Numero" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[lpad(($P{TABLE}.documentno::numeric)::character varying,20,' ')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="d151a4f8-f1a9-9791-f7ed-b494310d4198" Identifier="f29b61bb-2fb7-3899-a8fa-f0db197f9e21" IsParent="false" Name="Correlativo + tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.fact_id_seq)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="e73b53f9-ce7c-a2f5-481b-932d035cb776" Identifier="58c8e835-4b23-43e8-84a0-621e759cf109" IsParent="false" Name="Correlativo+tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right((coalesce(min(case when amtacctdr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctdr < 0 then ($P{TABLE}.fact_id) end))),9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="a1a81289-2ed3-5ffd-f96e-0382fb926a4c" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="d40e89a0-20a0-83bd-aa8d-743570d4fcf1" IsParent="false" Name="Total" SeqNo="230" IsActive="true">
        <ColumnSQL><![CDATA[CurrencyConvert(((Select sum(linetotalamt) From c_invoiceline il Where il.C_Invoice_ID= $P{TABLE}.C_Invoice_ID and C_Tax_ID=1000096)*100.00/18.00 + $P{TABLE}.grandtotal), $P{TABLE}.C_Currency_ID, 308, $P{TABLE}.dateinvoiced, $P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="56857c11-9900-4549-8391-e9a120241c74" IsParent="false" Name="CantIngreso" SeqNo="170" IsActive="true">
        <ColumnSQL><![CDATA[round(($P{TABLE}.ingresoqty),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="f9fe6e66-3cb6-bf07-1470-f23f09d3bbcd" Identifier="d87d1198-7171-720e-59c8-75aa735cb87e" IsParent="false" Name="Fecha" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[to_char(min($P{TABLE}.dateacct),'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="f9fe6e66-3cb6-bf07-1470-f23f09d3bbcd" Identifier="53a3c7ec-2cdb-a71e-9b3a-c96cae23434c" IsParent="false" Name="Correativo+tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right ((COALESCE( min(case when left($P{TABLE}.fact_id,2)='14' then $P{TABLE}.fact_id  end ), min(case when left($P{TABLE}.fact_id,2)!='14' then $P{TABLE}.fact_id  end ))),9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="ae894c88-dd35-c7a5-cb42-654e1bd3acfa" IsParent="false" Name="estado" SeqNo="190" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="b400dafa-3168-4101-8856-81f198d69749" Identifier="23e312b1-d111-4d2a-a614-dea90c959cb9" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8d253def-98f6-8607-9ccf-483ed3a5ae31" Identifier="570c58a8-c332-4f58-be24-524ab4e39bce" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[coalesce(min(case when amtacctdr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctdr < 0 then ($P{TABLE}.fact_id) end))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="45e3d64f-19f3-b81e-898a-7551b23e8600" IsParent="false" Name="SerieRef" SeqNo="290" IsActive="true">
        <ColumnSQL><![CDATA['-'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c240f167-8422-e009-279b-ffcf85fdaf77" Identifier="4f66cf7f-6728-4a60-9307-1e010b6d9699" IsParent="false" Name="Amortizacion" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="cf3d8811-1abc-e1ad-9f7a-2fe585a04d17" IsParent="false" Name="Retencion" SeqNo="330" IsActive="true">
        <ColumnSQL><![CDATA[case when (SELECT max(c_invoice_id) from c_retention r where r.c_invoice_id = $P{TABLE}.c_invoice_id) = $P{TABLE}.c_invoice_id  then '1' else '' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="846876bb-6aab-4b00-ac52-3396381d088f" IsParent="false" Name="Adiciones" SeqNo="170" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="3c15eace-f753-4556-8a73-dd57270bc74a" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="b9a7525c-cdbc-3209-65b1-81be3aec8f7d" IsParent="false" Name="Campo21" SeqNo="210" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="58b1091c-7796-22b6-674f-6bd56a219d3e" IsParent="false" Name="Tip.Comprobante" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[(select codsunat from c_doctype  where c_doctype_id = $P{TABLE}.c_doctype_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="e73b53f9-ce7c-a2f5-481b-932d035cb776" Identifier="e55c43bc-6001-4590-bab0-ef91baf1cf0e" IsParent="false" Name="cantidadTitulos" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA['0'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="a5c84a6d-7292-ffaf-5fc8-d50767223578" IsParent="false" Name="Fecha" SeqNo="130" IsActive="true">
        <ColumnSQL><![CDATA[to_char(dateacct,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="046b172f-823a-eae7-c075-860857d77dc3" IsParent="false" Name="Tasa de Cambio" SeqNo="250" IsActive="true">
        <ColumnSQL><![CDATA[Case when $P{TABLE}.c_currency_id != 308 then round(currencyrate( $P{TABLE}.c_currency_id, 308,  $P{TABLE}.dateinvoiced,  $P{TABLE}.c_conversiontype_id,  $P{TABLE}.ad_client_id, 0),3) else '0.000' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="01e6e05f-08c2-4dbf-edf8-3b366753be40" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="958fb44d-516b-5954-a776-2c44e2169490" IsParent="false" Name="FechRef" SeqNo="270" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT to_char(dateinvoiced,'DD/MM/YYYY') FROM c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="77a4e4b9-df75-e5ac-a8a5-e1b73d0a3d8b" IsParent="false" Name="Total" SeqNo="230" IsActive="true">
        <ColumnSQL><![CDATA[CurrencyConvert($P{TABLE}.grandtotal,$P{TABLE}.C_Currency_ID, 308, $P{TABLE}.dateinvoiced, $P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="01e6e05f-08c2-4dbf-edf8-3b366753be40" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="34e2da52-3265-d9ee-1064-a16c8bd9cf5b" IsParent="false" Name="Tasa de cambio" SeqNo="260" IsActive="true">
        <ColumnSQL><![CDATA[Case when $P{TABLE}.c_currency_id !=308 then round(currencyrate($P{TABLE}.c_currency_id, 308, (Select dateinvoiced from c_invoice ir where ir.c_invoice_id = $P{TABLE}.ref_invoice_id), $P{TABLE}.c_conversiontype_id, $P{TABLE}.ad_client_id, 0),3) else '1.000'  end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8aa3c792-6bad-c926-94ba-5273be2c68fb" Identifier="1b6d70c4-07ba-7237-93ae-bc0b3d7c6491" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="278bc53a-25d8-976e-e0d1-4722a7988dd6" IsParent="false" Name="Tipo de moneda" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxcurrency)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="6ba912b2-1451-bf78-4b41-27cad9bc46db" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="8a1bae6c-08cd-ee1c-2c64-d70c929c8d00" IsParent="false" Name="Serie" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,3,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="d151a4f8-f1a9-9791-f7ed-b494310d4198" Identifier="9ecb5170-0f11-d511-8f07-c15ecef73214" IsParent="false" Name="Numero" SeqNo="120" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.documentno)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="36e98dfc-9dc2-3242-adf1-3a3b3aaca6ad" IsParent="false" Name="estado" SeqNo="210" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="ac3c6681-b111-956d-c982-42017c1e520e" IsParent="false" Name="Corr + tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right(fact_id,9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="60f302bf-2927-9d6b-683e-c2210819b5d2" IsParent="false" Name="Tipo de Docmento" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxdocument)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="81bb7588-bd12-e2f9-0ba0-99f127585e99" Identifier="5c8b21a3-b184-4d78-a2bd-2f110d01bbc7" IsParent="false" Name="DesProd" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.namep)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="514d1141-c72c-c0b3-0c0f-69910c69d121" IsParent="false" Name="TipRef" SeqNo="270" IsActive="true">
        <ColumnSQL><![CDATA['00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="2a832a4c-f81e-1526-4bc8-8de9b1c0cd4f" IsParent="false" Name="Deudor" SeqNo="180" IsActive="true">
        <ColumnSQL><![CDATA[round(amtacctdr,2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="4c713835-45bb-29d8-84c1-42fe394b0eb3" Identifier="1681c6f1-5870-a4d3-5c47-3963fb29dada" IsParent="false" Name="Correativo+tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right((coalesce(min(case when amtacctcr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctdr > 0 then ($P{TABLE}.fact_id) end))),9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="4a14c612-39a9-b8dd-0a46-a1f2074560e6" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="75ff32e0-a219-4030-8dc9-6fa722c45774" IsParent="false" Name="Total" SeqNo="230" IsActive="true">
        <ColumnSQL><![CDATA[CurrencyConvert($P{TABLE}.grandtotal,$P{TABLE}.C_Currency_ID, 308,(Select dateinvoiced from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id),$P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID) ::numeric]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="038272bf-a1e1-cbd6-d1bd-1d2fd7226191" IsParent="false" Name="Tasa de cambio" SeqNo="260" IsActive="true">
        <ColumnSQL><![CDATA[Case when $P{TABLE}.c_currency_id !=308 then round(currencyrate( $P{TABLE}.c_currency_id, 308,  $P{TABLE}.dateinvoiced,  $P{TABLE}.c_conversiontype_id,  $P{TABLE}.ad_client_id, 0),3) else '1.000' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="8f7be7b1-8c40-44f9-8641-c59c7d6eada2" IsParent="false" Name="MovDebe" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.debe_m)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="29dc6812-9df3-91db-2338-77e324fdce21" IsParent="false" Name="Glosa Ref." SeqNo="170" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="c826f177-73b0-4ab8-9b2a-972e40705796" IsParent="false" SeqNo="290" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="c7deb126-e567-4d5f-b15d-be276c08f182" IsParent="false" Name="CostoSaldo" SeqNo="240" IsActive="true">
        <ColumnSQL><![CDATA[round(($P{TABLE}.costo),4)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="81bb7588-bd12-e2f9-0ba0-99f127585e99" Identifier="1d77b6be-25cc-4558-85b2-d7cb4181b91b" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="d51c791a-e6bf-4078-8a1b-28f3b0f11c74" IsParent="false" Name="CodigoProducto" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.valuep)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="99da7703-6bdc-90dc-12af-d1ca605b0a08" IsParent="false" Name="Fecha" SeqNo="130" IsActive="true">
        <ColumnSQL><![CDATA[to_char(dateacct,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="690862a8-9af0-7cf9-a1a0-32eaf70ccde0" IsParent="false" Name="Tip.Comprobante" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[(case when $P{TABLE}.isdistribution = 'Y' then '00' when $P{TABLE}.ad_table_id = 735 then '00'  when $P{TABLE}.ad_table_id != 735 and coalesce($P{TABLE}.c_doctype_id,0) != 0  then (select codsunat from c_doctype  where c_doctype_id = $P{TABLE}.c_doctype_id) else '00' end)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="dbbb5954-4fbf-4ded-b4b1-ce616f121ed4" IsParent="false" Name="Campo 9" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="1f0fd39e-5a23-ed09-8648-fae3e8f358a1" IsParent="false" Name="Fechdetraccion" SeqNo="310" IsActive="true">
        <ColumnSQL><![CDATA[case when $P{TABLE}.isdetraction='Y' then  to_char(datedetraction,'DD/MM/YYYY')  else '01/01/0001' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="18988374-540c-c762-5c2f-87a085050605" Identifier="71604174-3961-963c-cbb2-01f728643422" IsParent="false" Name="Estado" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="dbbbb376-75e1-4f3c-a0ac-3a07782daaa1" IsParent="false" Name="Cuenta" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.valueacct)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="61ca47e4-239a-1d52-9a4c-2a0ce6406b01" IsParent="false" Name="NumRef" SeqNo="300" IsActive="true">
        <ColumnSQL><![CDATA['-'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="89ff0254-76f6-4b85-a019-3430e9ed64ff" IsParent="false" Name="Correlativo + tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right($P{TABLE}fact_id,9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="53ef0296-6910-6f5f-71c0-29c029578f41" IsParent="false" Name="Moneda" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[(select iso_code from c_currency  where c_currency_id = $P{TABLE}.c_currency_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="e73b53f9-ce7c-a2f5-481b-932d035cb776" Identifier="fdc8cbad-e4aa-4238-b1d5-46bbe7a3aeb0" IsParent="false" Name="Provision" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="9c884d22-7583-b8e6-6d0b-39e67cc77122" IsParent="false" Name="Deudor" SeqNo="180" IsActive="true">
        <ColumnSQL><![CDATA[round(amtacctdr,2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="c237ede1-c960-247f-3d43-913ed1cd68a2" IsParent="false" Name="Campo22" SeqNo="220" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="2f583c0d-8deb-ad39-804e-b89c6987ed46" IsParent="false" Name="campo20" SeqNo="210" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text21]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2e3cdd4-6c06-4ad2-90fd-87fc0f8a6cc4" Identifier="7a57ffba-4139-443f-b653-1ab8ae88e483" IsParent="false" Name="descripcion" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.description)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c8ed8dca-c62a-6a45-9710-a013ab04f0f9" Identifier="14475d2c-887a-8f28-eaa0-7c7a65ed436a" IsParent="false" Name="Monto" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.amtacctcr) - SUM($P{TABLE}.amtacctdr)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8aa3c792-6bad-c926-94ba-5273be2c68fb" Identifier="31264d1c-6f22-e6a9-250d-8698a75e7dc8" IsParent="false" Name="Fecha" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[to_char(min(datetrx),'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="f9fe6e66-3cb6-bf07-1470-f23f09d3bbcd" Identifier="7b14db57-8804-0dc1-b431-72bf8a51ee76" IsParent="false" Name="DocIdentidadSocio" SeqNo="50" IsActive="true">
	<ColumnSQL><![CDATA[($P{TABLE}.taxid)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="f620e77e-fbd4-46fc-bcfa-ed93210f3a0c" IsParent="false" Name="Fecha" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[to_char(($P{TABLE}.movementdate),'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="2f38d33b-bc50-47f3-d599-61456572e5db" IsParent="false" Name="FechaRef" SeqNo="260" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT to_char(dateinvoiced,'DD/MM/YYYY') FROM c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="ce48fbe6-f883-2511-70a8-7fd4c016579e" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[(CASE WHEN (rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC))::integer >= 10   THEN (fact_id)::text||'-'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) ELSE (fact_id)::text||'-0'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) END)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="46aa4be2-9af1-fcc3-e7a6-bcefcbdc3d25" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="bf43eecf-210a-a94e-26e3-5ea80889b8d9" IsParent="false" Name="Tasa de cambio" SeqNo="250" IsActive="true">
        <ColumnSQL><![CDATA[Case when $P{TABLE}.c_currency_id != 308 then round(currencyrate($P{TABLE}.c_currency_id, 308, (Select dateinvoiced from c_invoice ir where ir.c_invoice_id = $P{TABLE}.ref_invoice_id), $P{TABLE}.c_conversiontype_id, $P{TABLE}.ad_client_id, 0),3) else '0.000'  end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="03005109-fee9-479c-820c-c5d31b516912" IsParent="false" Name="Estado" SeqNo="190" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="1692b147-ed3a-d58f-96a6-a3fcecfe8615" IsParent="false" Name="BaseGravada" SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[(case when $P{TABLE}.docstatus = 'CO' then ( case when gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'IGV'::text, 'BASE'::text)!=0 then round(gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'IGV'::text, 'BASE'::text),2) else '0.00' end ) else '0.00' end )]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="babfb5ec-f2c3-1540-abd1-e05e71aa69b1" IsParent="false" Name="TipoIDProv" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA[CASE WHEN (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'R' then '6'  when (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'D' then '1' else  0 end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="46aa4be2-9af1-fcc3-e7a6-bcefcbdc3d25" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="6d83ecf1-98df-fc29-6a2b-5e3d6c2075e0" IsParent="false" Name="SerieRef" SeqNo="280" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad(serial,4,'0') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="5664a25e-e0c5-4158-b4f2-564c1ef4deb9" Identifier="3ecfd42b-bfb7-46a1-99ff-5ed98997bf33" IsParent="false" Name="Descripcion cta corporativa" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="95188834-3c32-4468-9528-bd8ca559719d" IsParent="false" Name="TipoOperacion" SeqNo="130" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.movementtype)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="0902b027-b602-6422-a81b-19f30828d5df" IsParent="false" Name="Cliente" SeqNo="120" IsActive="true">
        <ColumnSQL><![CDATA[(select name from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="c4bd01f5-aed1-333c-3391-4d75fd68b92d" IsParent="false" Name="estado" SeqNo="410" IsActive="true">
        <ColumnSQL><![CDATA['0'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="6d2b9066-9c55-bf95-14e0-d3f6adfd34a4" IsParent="false" Name="TipoComprobante" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[(select codsunat from c_doctype  where c_doctype_id = $P{TABLE}.c_doctype_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="0521c12a-6528-56cb-eadc-d7d908424165" IsParent="false" Name="Estado" SeqNo="210" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="dd57d4b8-7d85-0a0e-452f-5a576c4bbaa3" IsParent="false" Name="Moneda" SeqNo="250" IsActive="true">
        <ColumnSQL><![CDATA[(select iso_code from c_currency  where c_currency_id = $P{TABLE}.c_currency_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a57b90d9-0301-e69f-8198-e190d883e100" Identifier="bf91794e-8842-321e-eba7-619d74591412" IsParent="false" Name="Estado" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="aa13ade8-a611-4530-94aa-6cb855840d8a" IsParent="false" SeqNo="320" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8aa3c792-6bad-c926-94ba-5273be2c68fb" Identifier="5d8b3c28-f89d-42df-06e3-9dd856f1db00" IsParent="false" Name="Nombre" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.namebp)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2e3cdd4-6c06-4ad2-90fd-87fc0f8a6cc4" Identifier="d198374d-959c-4d87-b19e-f77495573bd0" IsParent="false" Name="Adiciones" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="a2bf772d-6beb-75eb-248d-e0aed5a556f3" IsParent="false" Name="Correlativo + tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA[(case when isopendocument = 'Y' then 'A' ELSE (case when isclosedocument = 'Y' then 'C' else 'M' end)end)||right((CASE  WHEN (rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC))::integer >= 10   THEN (fact_id)::text||'-'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) ELSE (fact_id)::text||'-0'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC))  END),9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="46aa4be2-9af1-fcc3-e7a6-bcefcbdc3d25" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="8ba34942-a443-a221-e37f-35b75cad0146" IsParent="false" Name="Total" SeqNo="230" IsActive="true">
        <ColumnSQL><![CDATA[CurrencyConvert($P{TABLE}.grandtotal,$P{TABLE}.C_Currency_ID, 308,(Select dateinvoiced from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id),$P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID) * (-1)::numeric]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="28d236a7-4180-47b3-b6f6-be00dd2d97e2" IsParent="false" Name="Otros" SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="3d08cde2-66c6-bac8-8a8f-4d30439f19d6" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="afa34fad-6caf-281a-0301-c90e2137987d" IsParent="false" Name="Tasa de cambio" SeqNo="260" IsActive="true">
        <ColumnSQL><![CDATA[Case when $P{TABLE}.c_currency_id !=308 then round(currencyrate($P{TABLE}.c_currency_id, 308, (Select dateinvoiced from c_invoice ir where ir.c_invoice_id = $P{TABLE}.ref_invoice_id), $P{TABLE}.c_conversiontype_id, $P{TABLE}.ad_client_id, 0),3) else '1.000'  end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="a1f5cb26-8245-5864-3a50-ca61ebb755f3" IsParent="false" Name="FechRef" SeqNo="270" IsActive="true">
        <ColumnSQL><![CDATA['01/01/0001'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="41c8b837-12ba-0737-d7bb-404e4ec6b7de" Identifier="be361241-f164-42f7-8a83-c7f7720c0f76" IsParent="false" Name="Rubro" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxid)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="30cf59e8-7115-feed-28b1-79123f969fc5" IsParent="false" Name="Campo16" SeqNo="160" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="529969cc-b6b3-dde2-a642-b697c0d3c88b" IsParent="false" Name="Cod.Centro Costo" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="b400dafa-3168-4101-8856-81f198d69749" Identifier="3798468a-0752-4b6d-b0ba-b9884f8b40a3" IsParent="false" Name="Importe" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.amtacctcr) - SUM($P{TABLE}.amtacctdr)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="b5e9960d-f34c-a990-9222-7ca8e4572f8a" IsParent="false" Name="Libro" SeqNo="200" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="4c713835-45bb-29d8-84c1-42fe394b0eb3" Identifier="e104da1a-1293-6b01-3b73-fa42123d1e80" IsParent="false" Name="DocIdentidadSocio" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxid)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="745680a0-a50b-05da-dea4-e5f6ec4d6545" IsParent="false" Name="TipRef" SeqNo="280" IsActive="true">
        <ColumnSQL><![CDATA['00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="3d08cde2-66c6-bac8-8a8f-4d30439f19d6" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="d68d8daf-11f1-c1ec-fd3c-3fd9bc122d0c" IsParent="false" Name="FechRef" SeqNo="270" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT to_char(dateinvoiced,'DD/MM/YYYY') FROM c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="5d978b13-dbf3-4702-bc74-aa711308c86e" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="592d5b63-33be-a10c-600d-92f25ef8bca7" IsParent="false" Name="NoGravada" SeqNo="200" IsActive="true">
        <ColumnSQL><![CDATA[case when gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'NGR'::text, 'BASE'::text) > 0 then gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'NGR'::text, 'BASE'::text) else '0.00' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="18988374-540c-c762-5c2f-87a085050605" Identifier="2da85931-4f7f-a408-922e-155c7b3f635e" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="9e881a0a-e170-4903-b744-5514b81a3d90" IsParent="false" Name="BalanceDebe" SeqNo="130" IsActive="true">
        <ColumnSQL><![CDATA[round((case when (SUM($P{TABLE}.activo_b) - SUM($P{TABLE}.pasivo_b))>0 then (SUM($P{TABLE}.activo_b) - SUM($P{TABLE}.pasivo_b)) else 0 end),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="4c713835-45bb-29d8-84c1-42fe394b0eb3" Identifier="6b8cbc63-5b3b-41d7-e392-3a08a63ba9d8" IsParent="false" Name="TipoDocIdentidad" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxtype)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="4c713835-45bb-29d8-84c1-42fe394b0eb3" Identifier="21daf22b-8b65-a831-afa7-10d28a60751c" IsParent="false" Name="Cuenta" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.valueacct)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="c0c402db-aa31-0c75-b031-14d2fd57e57c" IsParent="false" Name="Moneda" SeqNo="240" IsActive="true">
        <ColumnSQL><![CDATA[(select iso_code from c_currency  where c_currency_id = $P{TABLE}.c_currency_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="8a192094-6703-4d6b-91d4-f82447fd0c68" IsParent="false" Name="Cod.Unid.Ope" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="e1e90664-07d7-cceb-cbd3-4a0dbc1a56e3" IsParent="false" Name="tipo de gasto" SeqNo="340" IsActive="true">
        <ColumnSQL><![CDATA[CASE WHEN (SELECT max(po_gs) from m_product p join c_invoiceline il on c_invoice.c_invoice_id = il.c_invoice_id     where p.m_product_id = il.m_product_id) ISNULL THEN     (SELECT max(po_gs) from c_charge c join c_invoiceline il on c_invoice.c_invoice_id = il.c_invoice_id where c.c_charge_id = il.c_charge_id)     ELSE     (SELECT max(po_gs) from m_product p join c_invoiceline il on c_invoice.c_invoice_id = il.c_invoice_id where p.m_product_id = il.m_product_id) end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="672fd273-bd9d-47c6-acc0-1069e8c3627f" IsParent="false" Name="Ingresos" SeqNo="160" IsActive="true">
        <ColumnSQL><![CDATA[round(($P{TABLE}.ingresoqty),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="f8ab4017-62e1-8dbf-900a-31c96197d02e" IsParent="false" Name="NroDoc" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[lpad(($P{TABLE}.documentno::numeric)::character varying,20,' ')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="1e006731-48a1-8b0e-7898-be28d6747f2e" IsParent="false" Name="campo20" SeqNo="200" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="25e25ea7-3f53-ea73-e1e9-f3706cd4e7ea" Identifier="134baae4-570e-43dc-bb3d-fcbcb5a05cee" IsParent="false" Name="Rubro" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxid)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="fc9b17a8-aac1-bf47-db76-65c46560596f" IsParent="false" Name="NoGravada" SeqNo="200" IsActive="true">
        <ColumnSQL><![CDATA[case when gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'NGR'::text, 'BASE'::text) > 0 then gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'NGR'::text, 'BASE'::text) else '0.00' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="e6d2460b-6b3e-9b58-0267-c7d2a2ec6fd0" IsParent="false" Name="Campo36" SeqNo="360" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="f9fe6e66-3cb6-bf07-1470-f23f09d3bbcd" Identifier="ab1060b6-8669-8610-b888-fdb4775fdb83" IsParent="false" Name="TipoDocIdentidad" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxtype)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="f88d1e9d-b5f7-b3a4-a60c-23086851e5c7" IsParent="false" Name="NroCorrelativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.fact_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="f93c0c27-b823-4759-acba-49bea4787671" IsParent="false" Name="TipoDoc" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.documenttype)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="80117cb5-4ed9-11e8-0cbd-feacb70df5c8" IsParent="false" Name="Campo19" SeqNo="190" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2e3cdd4-6c06-4ad2-90fd-87fc0f8a6cc4" Identifier="600c9850-5ac2-4e0c-9c8c-da3ca750a855" IsParent="false" Name="TipoDoc" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxid)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="7552ad10-87a8-a1cf-4e91-15e26c804a66" IsParent="false" Name="Campo17" SeqNo="170" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="fb73af3c-0815-4722-9bd3-b3c57b50ee7b" IsParent="false" Name="TotHaber" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.haber_f)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="bc441b38-c3f4-8b82-6c69-f17c5f88a4db" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="8f0bc535-4362-c4ed-2098-dea0c7e5ad12" IsParent="false" Name="Inafecta" SeqNo="190" IsActive="true">
        <ColumnSQL><![CDATA[case when gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'NGR'::text, 'BASE'::text) > 0 then gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'NGR'::text, 'BASE'::text) else '0.00' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="6ba912b2-1451-bf78-4b41-27cad9bc46db" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="1ebc8b28-7f69-4761-704c-46afd6870a03" IsParent="false" Name="BaseGravada" SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[CurrencyConvert(((Select sum(linetotalamt) From c_invoiceline il Where il.C_Invoice_ID= $P{TABLE}.C_Invoice_ID and C_Tax_ID=1000096)*100.00/18.00), $P{TABLE}.C_Currency_ID, 308, $P{TABLE}.dateinvoiced, $P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2e3cdd4-6c06-4ad2-90fd-87fc0f8a6cc4" Identifier="496f3e8e-cc6d-47ef-8347-717a4b1f323c" IsParent="false" Name="Numero" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[lpad(($P{TABLE}.invoicedocumentno::numeric)::character varying,20,' ')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="01e6e05f-08c2-4dbf-edf8-3b366753be40" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="9ccd4209-57d0-0ebc-0255-642460d76dcc" IsParent="false" Name="TipRef" SeqNo="280" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT codsunat from c_doctype where c_doctype_id in (SELECT c_doctype_id  from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="7ce00e91-a021-f84c-9750-37cf26144c89" IsParent="false" Name="campo8" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1d81ccef-0699-4065-8898-b6263b549f33" Identifier="4d3b10da-7c48-4f18-96b5-a0b6ec37cbca" IsParent="false" Name="Estado" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="b7c71b70-7165-4629-a099-5da0f85e5227" IsParent="false" Name="CatExistencia" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="8b94cd4f-df30-b799-ec59-12ad3fb3b2fb" IsParent="false" Name="Campo34" SeqNo="340" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="ff33d42d-1285-a485-a17c-6b9a2221c990" IsParent="false" Name="Estado" SeqNo="210" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="d151a4f8-f1a9-9791-f7ed-b494310d4198" Identifier="99afe912-3b2f-3c1f-388e-3964f843e12e" IsParent="false" Name="deudor" SeqNo="130" IsActive="true">
        <ColumnSQL><![CDATA[round(amtacctdr,2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="b7b3a5b2-9109-51b3-879b-298203af41aa" IsParent="false" Name="Libro" SeqNo="180" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="3c0ed060-855c-a76f-216d-9717abf92cae" IsParent="false" Name="Glosa ref." SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c8ed8dca-c62a-6a45-9710-a013ab04f0f9" Identifier="e9b4ac72-88eb-576f-ff95-8f5160c5091f" IsParent="false" Name="Estado" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="badbd3e8-fe8c-432e-8bd5-b603349a6de7" IsParent="false" Name="TipoOperacion" SeqNo="130" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.movementtype)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="25e25ea7-3f53-ea73-e1e9-f3706cd4e7ea" Identifier="509b93a0-ceff-4a20-9855-1e512de54ba9" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="ec0b0d8c-82dd-f64e-a8f7-bce5325b7513" IsParent="false" Name="Cod.Centro Costo" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="0845abb7-05e4-43a6-a59a-4ba6843c1a2d" IsParent="false" Name="TotDebe" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.debe_f)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c8ed8dca-c62a-6a45-9710-a013ab04f0f9" Identifier="0ec9a7f9-75bb-0c67-9510-2843c1f71a82" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[coalesce(min(case when amtacctcr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctdr > 0 then ($P{TABLE}.fact_id) end))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="abc3a41c-1053-4f9b-94fa-4b9cbd7e2ab7" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.fact_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="6f68d10d-2a14-9f7f-c3e3-7b6fdc922f4b" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="4a873646-d2fd-497b-b9d0-39859b8c5e30" IsParent="false" Name="Serie" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,3,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8d253def-98f6-8607-9ccf-483ed3a5ae31" Identifier="fd0b0cb7-87b9-44dd-bd81-b32b5aaf6e04" IsParent="false" Name="NÃºmero" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[lpad(($P{TABLE}.invoicedocumentno::numeric)::character varying,20,' ')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="9ae17d68-80a9-23de-ecc6-2bb00f255df8" IsParent="false" Name="FechRef" SeqNo="260" IsActive="true">
        <ColumnSQL><![CDATA['01/01/0001'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="311e91b5-1e18-4ae7-8829-9d036a382e2e" IsParent="false" Name="NroRUC" SeqNo="210" IsActive="true">
        <ColumnSQL><![CDATA[(select taxid from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="41c8b837-12ba-0737-d7bb-404e4ec6b7de" Identifier="a7b1c16b-143c-4ea2-a59f-6f50c2141595" IsParent="false" Name="Catalogo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA['01'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="c6c8af44-9607-8a77-7b70-c7cb556ea4c6" IsParent="false" Name="Campo19" SeqNo="190" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8d253def-98f6-8607-9ccf-483ed3a5ae31" Identifier="d0f894ed-8c8c-4030-b801-cc5621acfa53" IsParent="false" Name="TipComprobante" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.codsunat)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="76e2b964-a261-0962-4b9e-f4f31695e455" IsParent="false" Name="Correlativo + tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA[(case when isopendocument = 'Y' then 'A' ELSE (case when isclosedocument = 'Y' then 'C' else 'M' end)end)||right((CASE  WHEN (rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC))::integer >= 10   THEN (fact_id)::text||'-'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) ELSE (fact_id)::text||'-0'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC))  END),9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="d151a4f8-f1a9-9791-f7ed-b494310d4198" Identifier="02e64367-4c3a-9c7c-0400-4fcc88a5d7dd" IsParent="false" Name="Tip.Doc" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxid)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="38beda3e-2749-467a-b9c1-95b0a2392053" IsParent="false" SeqNo="250" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="47a176a7-ec5c-e32f-706d-abeda9e5747c" IsParent="false" Name="serie" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,4,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="d5ed58e3-9152-4ecd-b730-69ef7da00879" IsParent="false" SeqNo="270" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8d253def-98f6-8607-9ccf-483ed3a5ae31" Identifier="444c30ee-02d7-4a18-8803-c5bb5547bf43" IsParent="false" Name="Fecha" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[to_char(min(datetrx),'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="e94d1b54-7686-50fe-0a48-e55191ba0eeb" IsParent="false" Name="NoGravada" SeqNo="200" IsActive="true">
        <ColumnSQL><![CDATA[case when gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'NGR'::text, 'BASE'::text) != 0 then gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'NGR'::text, 'BASE'::text) else '0.00' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8aa3c792-6bad-c926-94ba-5273be2c68fb" Identifier="4946d6c4-93d4-b6ec-8324-9bf9c6835bde" IsParent="false" Name="Monto" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.amtacctcr) - SUM($P{TABLE}.amtacctdr)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="43695239-bf7d-4fe6-bb08-b1edb1399221" IsParent="false" Name="TipoExistencia" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.producttypetax)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="5ddd34fc-6a4e-47f1-ada0-4add27389b56" IsParent="false" Name="Moneda" SeqNo="160" IsActive="true">
        <ColumnSQL><![CDATA[(select iso_code from c_currency  where c_currency_id = $P{TABLE}.c_currency_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a57b90d9-0301-e69f-8198-e190d883e100" Identifier="c4bb92d6-7568-3e49-7c66-c82bebd12b9b" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="d7fd5a3c-fb6d-ce8f-d170-3231f539fe9e" IsParent="false" Name="Cuenta" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT zz.Value FROM C_ElementValue zz  WHERE zz.C_ElementValue_ID=Fact_Acct.account_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="81bb7588-bd12-e2f9-0ba0-99f127585e99" Identifier="d47719fa-6828-44b9-8d28-a680ac6a6614" IsParent="false" Name="Valuacion" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="743611c0-5f04-88cc-635c-469195b3b623" IsParent="false" Name="TipoComprobante" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[(select codsunat from c_doctype  where c_doctype_id = $P{TABLE}.c_doctype_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="88be1529-8927-fe1f-6b24-9f04ca781993" IsParent="false" Name="Cod.Unid.Ope" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="030b42f1-c045-4adb-a86b-ee7068d3c32b" IsParent="false" Name="Serie" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,4,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="240e1559-ba42-4a0b-9783-79847089703a" IsParent="false" Name="Salidas" SeqNo="170" IsActive="true">
        <ColumnSQL><![CDATA[round(($P{TABLE}.salidaqty),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="46aa4be2-9af1-fcc3-e7a6-bcefcbdc3d25" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="79de3ff8-cd05-bba3-fb27-6c6e007daa29" IsParent="false" Name="NoGravada" SeqNo="200" IsActive="true">
        <ColumnSQL><![CDATA[case when gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'NGR'::text, 'BASE'::text) != 0 then gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'NGR'::text, 'BASE'::text) else '0.00' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="76590faa-3edd-cb04-ffa4-a7f0373a578c" IsParent="false" Name="NumRef" SeqNo="300" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad((documentno::numeric)::character varying,20,' ') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8aa3c792-6bad-c926-94ba-5273be2c68fb" Identifier="8e210e1c-922a-a012-6aa8-243a428ad70b" IsParent="false" Name="TipoDocIdentidad" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxtype)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="f38d75eb-3666-3dfa-2c45-fb3ca6e9982a" IsParent="false" Name="ID Contrato" SeqNo="310" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="e73b53f9-ce7c-a2f5-481b-932d035cb776" Identifier="79ea7667-053f-4941-b8c5-26fa46acda80" IsParent="false" Name="TipoDocIdentidad" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxtype)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="af486648-cd7c-1d9a-f015-7bb7e44e80c4" IsParent="false" Name="Serie" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,4,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a57b90d9-0301-e69f-8198-e190d883e100" Identifier="11df1e3d-bf27-0731-9b75-3ad04f629b5f" IsParent="false" Name="Fecha" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[to_char(min($P{TABLE}.datetrx),'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="18988374-540c-c762-5c2f-87a085050605" Identifier="0725b3c0-801a-84db-6f7b-ce1bbf87f30c" IsParent="false" Name="Nombre" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.namebp)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="2ac55dcb-50cc-c7c9-b91f-3dfd8eb5a5e6" Identifier="6bd9de1d-7996-5192-c32b-da33298ab4ed" IsParent="false" Name="Debe" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[round((case when ((sum($P{TABLE}.amtacctdr))-sum($P{TABLE}.amtacctcr))> 0 then((sum($P{TABLE}.amtacctdr))-sum($P{TABLE}.amtacctcr))else 0 end),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="4b3215e0-cd17-0821-ab96-608b6042bd53" IsParent="false" Name="Fech.Vcto." SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c8ed8dca-c62a-6a45-9710-a013ab04f0f9" Identifier="29b1093e-066b-dc4a-983c-f1ce396dab8b" IsParent="false" Name="Nombre" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.namebp)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="3d08cde2-66c6-bac8-8a8f-4d30439f19d6" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="9f135c81-0eec-81e6-d5c6-df9f68099b3b" IsParent="false" Name="Total" SeqNo="240" IsActive="true">
        <ColumnSQL><![CDATA[CurrencyConvert($P{TABLE}.grandtotal,$P{TABLE}.C_Currency_ID, 308,(Select dateinvoiced from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id),$P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID) * (-1)::numeric]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c8ed8dca-c62a-6a45-9710-a013ab04f0f9" Identifier="f3068855-c49c-8943-dcd0-6d2eab9fdecd" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="3d08cde2-66c6-bac8-8a8f-4d30439f19d6" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="dc59471b-32d9-fe74-d9b8-840607c3007b" IsParent="false" Name="NumRef" SeqNo="300" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad(documentno,20,'') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="792c37c7-c061-e489-4e41-0f1e0a9d8132" IsParent="false" Name="FechVcto" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="affa875f-c957-6126-3d9d-48132d4ea96c" IsParent="false" Name="Campo40" SeqNo="400" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="e73b53f9-ce7c-a2f5-481b-932d035cb776" Identifier="f5281244-eeac-4685-924b-9ce1c1e82486" IsParent="false" Name="Estado" SeqNo="120" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="1db8add3-a21a-df2c-041d-fdb3c9c41f44" IsParent="false" Name="campo22" SeqNo="220" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="ab88e406-c430-03df-2547-82502f8f57e4" IsParent="false" Name="Campo39" SeqNo="390" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="0d90c184-50c6-2acd-c737-856535c6f2ff" IsParent="false" Name="Tip.Doc" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[CASE WHEN (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'R' then '6'  when (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'D' then '1' else  0 end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="b400dafa-3168-4101-8856-81f198d69749" Identifier="07d09cd8-dd73-4de3-82ac-71071988a060" IsParent="false" Name="ValorNomAccion" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA[round((max($P{TABLE}.nominal_value)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="6ba912b2-1451-bf78-4b41-27cad9bc46db" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="44e97c98-d939-18ed-a934-b4e1dbfd06e0" IsParent="false" Name="IGV" SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA[CurrencyConvert((Select sum(linetotalamt) From c_invoiceline il Where il.C_Invoice_ID= $P{TABLE}.C_Invoice_ID and C_Tax_ID=1000096), $P{TABLE}.C_Currency_ID, 308, $P{TABLE}.dateinvoiced, $P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="cab160f2-cbd6-4c59-810e-a486afb80abf" IsParent="false" Name="ResHaber" SeqNo="160" IsActive="true">
        <ColumnSQL><![CDATA[round((case when (SUM($P{TABLE}.ingreso_rn) - SUM($P{TABLE}.gasto_rn))>0 then (SUM($P{TABLE}.ingreso_rn) - SUM($P{TABLE}.gasto_rn)) else 0 end),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="5664a25e-e0c5-4158-b4f2-564c1ef4deb9" Identifier="fd308d99-a079-4d57-9168-6f4ee9576abe" IsParent="false" Name="Descripcion" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="a3b3629d-13ce-4610-f1de-aa49328b44e5" IsParent="false" Name="Numero" SeqNo="120" IsActive="true">
        <ColumnSQL><![CDATA[(case when coalesce($P{TABLE}.c_doctype_id,00) = 00 then ($P{TABLE}.fact_acct_id::character varying) when  (select codsunat from c_doctype  where c_doctype_id = $P{TABLE}.c_doctype_id)= '00' then lpad($P{TABLE}.invoicedocumentno,20,' ') else lpad(( substring($P{TABLE}.invoicedocumentno,'(\d+)' )::numeric)::character varying,20,' ')  end)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="5e487174-8080-aa2b-7a5b-3694892fb13f" IsParent="false" Name="Campo38" SeqNo="380" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="cfd0ad98-800e-7ec9-df54-a05f7e2223e9" IsParent="false" Name="FechaEmisi9on" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[to_char(dateinvoiced,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="f4be4e68-eba5-02a7-dcaf-e7cc55b161cf" IsParent="false" Name="FechRef" SeqNo="270" IsActive="true">
        <ColumnSQL><![CDATA['01/01/0001'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="85ff7055-8d8c-8f81-7a98-cbdbbc3ebca4" IsParent="false" Name="NroRUC" SeqNo="120" IsActive="true">
        <ColumnSQL><![CDATA[(select taxid from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="2a95c80c-91fb-f7f1-7795-23ed084a36fe" IsParent="false" Name="TipDoc" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[CASE WHEN (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'R' then '6'  when (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'D' then '1' else  0 end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="25e25ea7-3f53-ea73-e1e9-f3706cd4e7ea" Identifier="ef0582c6-6253-48df-9547-1b997886cb86" IsParent="false" Name="Estado" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="4c713835-45bb-29d8-84c1-42fe394b0eb3" Identifier="8dee5205-1afc-47cb-fb1d-78f622dad6ad" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[coalesce(min(case when amtacctcr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctdr >0 then ($P{TABLE}.fact_id) end))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="dd8d3d83-7efa-9901-0436-74c74ac4ee2d" IsParent="false" Name="Fech.emision" SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA[to_char(datetrx,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="c6edb655-1f11-4619-82ca-486aa7946447" IsParent="false" Name="SaldoHaber" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[round((case when (SUM($P{TABLE}.haber_f) - SUM($P{TABLE}.debe_f))>0 then (SUM($P{TABLE}.haber_f) - SUM($P{TABLE}.debe_f)) else 0 end),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="5f37b23e-1b56-2536-c054-6cdff7c73bd4" IsParent="false" Name="Medio de pago" SeqNo="330" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="01e6e05f-08c2-4dbf-edf8-3b366753be40" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="efe511de-b87b-9ce9-31ca-5ebbf5f444e6" IsParent="false" Name="Total" SeqNo="240" IsActive="true">
        <ColumnSQL><![CDATA[(case when $P{TABLE}.docstatus = 'CO' then (CurrencyConvert($P{TABLE}.grandtotal,$P{TABLE}.C_Currency_ID, 308,(Select dateinvoiced from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id),$P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID) * (-1)::numeric) else '0.00' end )]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="a7ec4876-dd5a-1389-942f-35b7958db0ed" IsParent="false" Name="Fech.Vcto" SeqNo="120" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="9237538e-5ea2-bc4c-a60f-d4900976a2bf" IsParent="false" Name="Total" SeqNo="230" IsActive="true">
        <ColumnSQL><![CDATA[CurrencyConvert($P{TABLE}.grandtotal,$P{TABLE}.C_Currency_ID, 308,(Select dateinvoiced from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id),$P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID) * (-1)::numeric]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="b1612593-fc26-d4fd-2bfe-0c3ab6dbbbb5" IsParent="false" Name="Campo37" SeqNo="370" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="4a14c612-39a9-b8dd-0a46-a1f2074560e6" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="2315d3e6-b104-3cb8-37db-ee8045c01bee" IsParent="false" Name="TipRef" SeqNo="270" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT codsunat from c_doctype where c_doctype_id in (SELECT c_doctype_id  from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="358e32b6-6d0d-94a5-cb3a-c57c53d489aa" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="99f98e5d-53e3-4ec1-4562-fe83f511b0c7" IsParent="false" Name="IGV" SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA[round(gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'IGV'::text, 'IGV'::text),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="07f8940a-c2a5-e6a9-668a-52284e9d1b5f" IsParent="false" Name="IGV" SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA[round(gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'IGV'::text, 'IGV'::text),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="3d08cde2-66c6-bac8-8a8f-4d30439f19d6" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="f5d6698b-85b5-0760-8a83-ab7777f3239e" IsParent="false" Name="FechRef" SeqNo="270" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT to_char(dateinvoiced,'DD/MM/YYYY') FROM c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="22c1d505-296a-6010-1ff3-8e2249652afb" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="9baabe4c-442e-edee-6f10-f0771c6dbe64" IsParent="false" Name="Estado" SeqNo="410" IsActive="true">
        <ColumnSQL><![CDATA['0'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="19251eac-438c-06d5-a5aa-297ea14aa7f3" IsParent="false" Name="deudor" SeqNo="180" IsActive="true">
        <ColumnSQL><![CDATA[round(amtacctdr,2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="f9fe6e66-3cb6-bf07-1470-f23f09d3bbcd" Identifier="081d6983-3910-8d55-224e-7ac87deff24a" IsParent="false" Name="Monto" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="8845db25-1d6e-261c-a274-1a674a95bbed" IsParent="false" Name="SerieRef" SeqNo="290" IsActive="true">
        <ColumnSQL><![CDATA['-'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="8a411778-d696-778f-65c7-1cfe0dc13003" IsParent="false" Name="campo22" SeqNo="220" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="e73b53f9-ce7c-a2f5-481b-932d035cb776" Identifier="ae30c086-b090-49b1-9d3d-23f0c89569f2" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="909d5bef-183f-32c5-7a51-0333fceb3a1f" IsParent="false" Name="NumRef" SeqNo="300" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad((documentno::numeric)::character varying,20,' ') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" ColumnName="DocumentNo" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="eb65d983-15fb-5eb7-6cca-0765d6d821f1" IsParent="false" Name="Numero" SeqNo="80" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" ColumnName="description" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="6b2b1aef-c127-5ea1-7827-79a399f1b525" IsParent="false" Name="Glosa" SeqNo="160" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="ab90336e-d4c3-61b1-096e-c06f5703bd95" IsParent="false" Name="campo8" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[Case when coalesce($P{TABLE}.documentno,'')!= null then lpad(($P{TABLE}.documentto::numeric)::character varying,20,' ') else '' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a57b90d9-0301-e69f-8198-e190d883e100" Identifier="09924cb4-898b-cc77-a194-2e310ec2fa89" IsParent="false" Name="DocIdentidadSocio" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxid)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c240f167-8422-e009-279b-ffcf85fdaf77" Identifier="f6db11c8-bfe2-4739-8aa9-26eb3b8e17df" IsParent="false" Name="Cuenta" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.valueacct)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="eacc1ea9-89b4-fb28-0031-a3731314a9ef" IsParent="false" Name="Tasa de Cambio" SeqNo="250" IsActive="true">
        <ColumnSQL><![CDATA[Case when $P{TABLE}.c_currency_id != 308 then round(currencyrate($P{TABLE}.c_currency_id, 308, (Select dateinvoiced from c_invoice ir where ir.c_invoice_id = $P{TABLE}.ref_invoice_id), $P{TABLE}.c_conversiontype_id, $P{TABLE}.ad_client_id, 0),3) else '1.000'  end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="eaa32efb-895b-3a59-e8d7-605b83df3de4" IsParent="false" Name="TipoComprobante" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[(select codsunat from c_doctype  where c_doctype_id = $P{TABLE}.c_doctype_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="2ff0541b-3747-de87-7ed7-b1c409690405" IsParent="false" Name="estado" SeqNo="410" IsActive="true">
        <ColumnSQL><![CDATA[case when EXTRACT(year from $P{TABLE}.dateinvoiced) = EXTRACT(year from $P{TABLE}.dateacct) then (case when EXTRACT(month from $P{TABLE}.dateinvoiced) = EXTRACT(month from $P{TABLE}.dateacct) then '1' when EXTRACT(month from $P{TABLE}.dateinvoiced) < EXTRACT(month from $P{TABLE}.dateacct) then '6' else 'otro' end) when EXTRACT(year from $P{TABLE}.dateacct) - EXTRACT(year from $P{TABLE}.dateinvoiced) = 1 then (case when EXTRACT(month from $P{TABLE}.dateinvoiced) >= EXTRACT(month from $P{TABLE}.dateacct) then '6' else '7' end) when EXTRACT(year from $P{TABLE}.dateacct) - EXTRACT(year from $P{TABLE}.dateinvoiced) >1 then '7' else 'otro' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="d151a4f8-f1a9-9791-f7ed-b494310d4198" Identifier="130db6f7-32a7-e0e0-1787-12f3c982481c" IsParent="false" Name="acreedor" SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[round(amtacctcr,2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="42c6073e-8c0b-a398-fdd4-eed83c7eb82b" IsParent="false" Name="Fech.Vcto." SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="8c3b7bf8-737e-35e6-b18e-007d14b0e776" IsParent="false" Name="ID contrato" SeqNo="310" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="b2bcb1b7-2041-4b0c-928e-da3ad338bc27" IsParent="false" Name="Correlativo + tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right(fact_id,9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1d81ccef-0699-4065-8898-b6263b549f33" Identifier="4fc8f406-e062-41bc-b45a-4425e1f254ab" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="fe7a231f-a7a9-99a5-5044-d4dd858071d5" IsParent="false" Name="NroRUC" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA[(select taxid from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="e73b53f9-ce7c-a2f5-481b-932d035cb776" Identifier="73f6f74a-fa9b-4dc7-9d54-49360101122d" IsParent="false" Name="ValorUnitario" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA['0'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8d253def-98f6-8607-9ccf-483ed3a5ae31" Identifier="5f8dd365-6011-40f9-994c-fec95a917bd9" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="ef4ad11f-b961-95b7-4c42-d5f26267572b" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="41c8b837-12ba-0737-d7bb-404e4ec6b7de" Identifier="db838835-610a-4a2b-828f-36e81b2e117b" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="d3cf96c7-f8f8-40bc-a6e5-75a5c71cbe93" IsParent="false" Name="Almacen" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.valuew)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="e73b53f9-ce7c-a2f5-481b-932d035cb776" Identifier="fa0369fc-c5ae-4c22-a59d-989898b81bd3" IsParent="false" Name="CostoTotal" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="3105a421-a1ee-e706-d035-7a0b5f50dee3" IsParent="false" Name="Estado" SeqNo="340" IsActive="true">
        <ColumnSQL><![CDATA[(case when  $P{TABLE}.docstatus='VO' then '2' when EXTRACT(year from  $P{TABLE}.dateinvoiced) = EXTRACT(year from  $P{TABLE}.dateacct) then '1' when EXTRACT(month from  $P{TABLE}.dateinvoiced) = EXTRACT(month from  $P{TABLE}.dateacct) then '1' when EXTRACT(month from  $P{TABLE}.dateinvoiced) < EXTRACT(month from $P{TABLE}.dateacct) then '8' when EXTRACT(year from  $P{TABLE}.dateinvoiced) < EXTRACT(year from  $P{TABLE}.dateacct) then '8' else 'otro' end)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="e6fdbf04-f01f-4400-88f9-58e0097a825a" IsParent="false" Name="Deducciones" SeqNo="180" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="55d70781-2c97-14df-24c7-f832e9b0e000" IsParent="false" Name="TipRef" SeqNo="270" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT codsunat from c_doctype where c_doctype_id in (SELECT c_doctype_id  from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="0b4ab49f-c32f-4572-c784-54308b057695" IsParent="false" Name="Campo37" SeqNo="370" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8d253def-98f6-8607-9ccf-483ed3a5ae31" Identifier="89807efa-86ab-4f9b-844b-b4ebb6895c72" IsParent="false" Name="Correlativo+tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right((coalesce(min(case when amtacctdr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctdr < 0 then ($P{TABLE}.fact_id) end))),9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1d81ccef-0699-4065-8898-b6263b549f33" Identifier="262826ce-2713-451b-98c2-38455b1a1360" IsParent="false" Name="Porcentaje de acciones" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[round(($P{TABLE}.percent),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="00c2e4e0-8225-abc0-f659-1048ef425469" IsParent="false" Name="Cuenta" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.valueacct)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="8f0aa62d-a164-ec4a-ac64-4b531560b4ab" IsParent="false" Name="AnioDUA" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA['0'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="144218f5-42f0-483d-bfd8-847040b95c1e" IsParent="false" Name="Serie" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,4,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" AD_Reference_ID="3cefd939-fdfe-f99a-8105-07955b81a4cd" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="f28f59f4-c4f5-02de-97ce-b02c358e1c8b" IsParent="false" Name="Proveedor" SeqNo="130" IsActive="true">
        <ColumnSQL><![CDATA[(select name from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="7cafc5ab-699e-8c43-cda0-abd4e48e1d7b" IsParent="false" Name="Corr + tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right(fact_id,9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="cda6afcc-e6e5-1062-a8ca-0c91cc5520cc" IsParent="false" Name="campo10" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[' '::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="b4bc6cbb-b9df-ee40-8cb9-5dfa1186faae" IsParent="false" Name="Fech.Vcto" SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[''::]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8d253def-98f6-8607-9ccf-483ed3a5ae31" Identifier="304809e0-a70d-487c-9fee-9c3a745eb688" IsParent="false" Name="Monto" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="6b19a288-d322-a906-5f54-c9e2a911f0ba" IsParent="false" Name="NroRUC" SeqNo="120" IsActive="true">
        <ColumnSQL><![CDATA[(select taxid from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="1330ad95-70fd-02be-40e1-67a3bbf9af27" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[(CASE WHEN (rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC))::integer >= 10  THEN (fact_id)::text||'-'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) ELSE (fact_id)::text||'-0'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) 	END)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="81bb7588-bd12-e2f9-0ba0-99f127585e99" Identifier="eacf16f3-3862-4e65-aaac-e474382d7374" IsParent="false" Name="CodigoProducto" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.valuep)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="3d08cde2-66c6-bac8-8a8f-4d30439f19d6" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="2b424654-899e-6202-1fb7-fc173c9ce42c" IsParent="false" Name="Total" SeqNo="240" IsActive="true">
        <ColumnSQL><![CDATA[(case when $P{TABLE}.docstatus = 'CO' then (CurrencyConvert($P{TABLE}.grandtotal,$P{TABLE}.C_Currency_ID, 308,(Select dateinvoiced from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id),$P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID) * (-1)::numeric) else '0.00' end)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="9b705679-f1ca-5aa8-b4b7-e045979cdc79" IsParent="false" Name="Acreedor" SeqNo="190" IsActive="true">
        <ColumnSQL><![CDATA[round(amtacctcr,2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="bf339281-c59c-705f-ca31-cd1a1f8008cc" IsParent="false" Name="campo23" SeqNo="230" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" ColumnName="fact_id" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="56d7672b-eabc-9c3c-bcf8-cc871f427dd6" IsParent="false" Name="Libro" SeqNo="200" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="81bb7588-bd12-e2f9-0ba0-99f127585e99" Identifier="db7680fb-76f9-4edc-82de-379052ce8e70" IsParent="false" Name="TipoExistencia" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.producttypetax)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="0db6eb1b-34b2-4c11-a01f-cf52efc07ef0" IsParent="false" Name="UnidadDe medida" SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.um)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="69718406-1309-4f37-b7e2-8b5710114299" IsParent="false" Name="Tasa de cambio" SeqNo="170" IsActive="true">
        <ColumnSQL><![CDATA[Case when $P{TABLE}.c_currency_id != 308 then round(currencyrate( $P{TABLE}.c_currency_id, 308,  $P{TABLE}.dateinvoiced,  $P{TABLE}.c_conversiontype_id,  $P{TABLE}.ad_client_id, 0),3) else '1.000' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="46aa4be2-9af1-fcc3-e7a6-bcefcbdc3d25" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="bc0de19d-078a-319f-9a61-bd448c136604" IsParent="false" Name="NumRef" SeqNo="300" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad(documentno,20,'') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2e3cdd4-6c06-4ad2-90fd-87fc0f8a6cc4" Identifier="000f7af8-7de4-431d-aea6-746c5db73209" IsParent="false" Name="Estado" SeqNo="120" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="c886cf7b-b77c-a262-8c64-9effda40b0f1" IsParent="false" Name="Tasa de cambio" SeqNo="260" IsActive="true">
        <ColumnSQL><![CDATA[Case when $P{TABLE}.c_currency_id !=308 then round(currencyrate( $P{TABLE}.c_currency_id, 308,  $P{TABLE}.dateinvoiced,  $P{TABLE}.c_conversiontype_id,  $P{TABLE}.ad_client_id, 0),3) else '1.000' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a57b90d9-0301-e69f-8198-e190d883e100" Identifier="fcdfe846-7d95-c255-967a-ac2e1572bf5b" IsParent="false" Name="TipoDocIdentidad" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxtype)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="d151a4f8-f1a9-9791-f7ed-b494310d4198" Identifier="602b4d00-21ef-5a1e-f239-cc60745b9548" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.fact_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="ef7415ab-ffef-440a-84b8-b911414a56c8" IsParent="false" Name="TransfDebe" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8d253def-98f6-8607-9ccf-483ed3a5ae31" Identifier="f3b9775e-dd38-4f37-b997-cb5b43aa5854" IsParent="false" Name="Estado" SeqNo="120" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1d81ccef-0699-4065-8898-b6263b549f33" Identifier="b546b744-a3cb-48dc-b99b-8883ccdcdcc5" IsParent="false" Name="Numero de Doc" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA[(select taxid from c_bpartner where $P{TABLE}.c_bpartner_id  = c_bpartner_id )]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="c9249f7a-0f7d-b5ff-842f-a2b4190452d1" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[(CASE WHEN (rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC))::integer >= 10  	THEN (fact_id)::text||'-'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) ELSE (fact_id)::text||'-0'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) END)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="98904b9d-3171-eb6f-226d-00954eb930fa" IsParent="false" Name="campo16" SeqNo="170" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="38c7d9f8-a4f8-4523-fd23-6af2c710b3f0" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[(CASE WHEN (rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC))::integer >= 10  THEN (fact_id)::text||'-'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) ELSE (fact_id)::text||'-0'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC))  END)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="9ff6db6a-148d-83c1-a4c9-142331eeb896" IsParent="false" Name="Campo17" SeqNo="170" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c240f167-8422-e009-279b-ffcf85fdaf77" Identifier="9a73cbb5-313e-4e4f-80af-92dc79c7209f" IsParent="false" Name="Descripcion" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.description)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c240f167-8422-e009-279b-ffcf85fdaf77" Identifier="84a3b04a-1c07-4fd4-8c37-c09aff6ca854" IsParent="false" Name="Estado" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="4a14c612-39a9-b8dd-0a46-a1f2074560e6" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="85f3a826-796c-4310-8de4-c7b98338c41a" IsParent="false" Name="Tasa de cambio" SeqNo="250" IsActive="true">
        <ColumnSQL><![CDATA[Case when $P{TABLE}.c_currency_id != 308 then round(currencyrate($P{TABLE}.c_currency_id, 308, (Select dateinvoiced from c_invoice ir where ir.c_invoice_id = $P{TABLE}.ref_invoice_id), $P{TABLE}.c_conversiontype_id, $P{TABLE}.ad_client_id, 0),3) else '0.000'  end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="e5a33cb2-f46f-21d7-044b-da1a26778b79" IsParent="false" Name="Campo35" SeqNo="350" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="1566c9c5-871b-489e-b375-cf445a74132d" IsParent="false" Name="ResDebe" SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA[round((case when (SUM($P{TABLE}.gasto_rn) - SUM($P{TABLE}.ingreso_rn))>0 then (SUM($P{TABLE}.gasto_rn) - SUM($P{TABLE}.ingreso_rn)) else 0 end),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="2ac55dcb-50cc-c7c9-b91f-3dfd8eb5a5e6" Identifier="cd015c29-7149-727f-5569-6541d36522fa" IsParent="false" Name="Codigo Banco" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.banktax)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="499fda95-53ce-ec02-c3ff-ddaace29d5e7" IsParent="false" Name="Campo18" SeqNo="180" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="5664a25e-e0c5-4158-b4f2-564c1ef4deb9" Identifier="0238a8de-a3db-4d74-b92b-9fe507a4b7f8" IsParent="false" Name="Cta Corporativa" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="6da265a4-f41e-ec6e-2863-0448e9ce9a44" IsParent="false" Name="Correlativo + tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA[(case when isopendocument = 'Y' then 'A' ELSE (case when isclosedocument = 'Y' then 'C' else 'M' end)end)||right((CASE 	WHEN (rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC))::integer >= 10  	THEN (fact_id)::text||'-'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) ELSE (fact_id)::text||'-0'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) 	END),9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="01e6e05f-08c2-4dbf-edf8-3b366753be40" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="d4dbf4ad-20b3-cc1c-d140-eb2ac5578741" IsParent="false" Name="Tasa de cambio" SeqNo="260" IsActive="true">
        <ColumnSQL><![CDATA[Case when $P{TABLE}.c_currency_id !=308 then round(currencyrate($P{TABLE}.c_currency_id, 308, (Select dateinvoiced from c_invoice ir where ir.c_invoice_id = $P{TABLE}.ref_invoice_id), $P{TABLE}.c_conversiontype_id, $P{TABLE}.ad_client_id, 0),3) else '1.000'  end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="3d08cde2-66c6-bac8-8a8f-4d30439f19d6" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="81f72851-4ff1-0136-baf7-7534fb8d3e20" IsParent="false" Name="SerieRef" SeqNo="290" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad(serial,4,'0') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="5664a25e-e0c5-4158-b4f2-564c1ef4deb9" Identifier="8300f744-07a7-43e6-bcf7-215657ca4bd3" IsParent="false" Name="Cuenta" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.value)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="d151a4f8-f1a9-9791-f7ed-b494310d4198" Identifier="b3b2cd74-f85e-9704-f2db-1194fc082305" IsParent="false" Name="Fech.Operac." SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[to_char(datetrx,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8aa3c792-6bad-c926-94ba-5273be2c68fb" Identifier="f6955f77-6b55-3b65-c8c8-69fcfde24615" IsParent="false" Name="Estado" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="3d08cde2-66c6-bac8-8a8f-4d30439f19d6" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="51595778-0f74-7eb7-348c-84782be40076" IsParent="false" Name="Tasa de Cambio" SeqNo="260" IsActive="true">
        <ColumnSQL><![CDATA[Case when $P{TABLE}.c_currency_id !=308 then round(currencyrate($P{TABLE}.c_currency_id, 308, (Select dateinvoiced from c_invoice ir where ir.c_invoice_id = $P{TABLE}.ref_invoice_id), $P{TABLE}.c_conversiontype_id, $P{TABLE}.ad_client_id, 0),3) else '1.000'  end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="37d47863-3522-e1da-c663-d2d720f1d4b5" IsParent="false" Name="Tip.Doc" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[CASE WHEN (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'R' then '6'  when (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'D' then '1' else  0 end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="18988374-540c-c762-5c2f-87a085050605" Identifier="54bd5cc7-db5a-c184-d75a-2b694b6c204b" IsParent="false" Name="TipoDocIdentidad" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxtype)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="2b1c990c-fad4-7288-6bce-c3b35b966bac" IsParent="false" Name="Libro" SeqNo="200" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="ec42e5ab-e11f-4b32-b01a-b9de6c1b4431" IsParent="false" Name="CostoIngreso" SeqNo="180" IsActive="true">
        <ColumnSQL><![CDATA[round(($P{TABLE}.incost),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" ColumnName="serial" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="1481bab2-1f1d-62cd-8cb6-d5deda1f8688" IsParent="false" Name="Serie" SeqNo="110" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="d0ea115c-ab7b-47ef-9a35-50b6c2763ff6" IsParent="false" Name="campo23" SeqNo="230" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="8c120b6c-e17d-029d-3770-6a773a6ae48e" IsParent="false" Name="Medio de pago" SeqNo="330" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="3ee7cf73-3396-5451-235e-79630be43bbf" IsParent="false" Name="Tip.Doc" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[CASE WHEN (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'R' then '6'  when (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'D' then '1' else  0 end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="7388e0ce-36ee-d127-2a28-76e679bb16dc" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="5baceea3-cca5-47ff-bf6a-d0e1cdaf6441" IsParent="false" Name="tabla 25" SeqNo="310" IsActive="true">
        <ColumnSQL><![CDATA['00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="87c343ca-4b01-d70f-3b26-3184ced03ee4" IsParent="false" Name="Numero RUC" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[(select taxid from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="b400dafa-3168-4101-8856-81f198d69749" Identifier="a922489f-9b5c-42d0-810b-bfcb68ab7322" IsParent="false" Name="Estado" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="6a39f68a-8cf6-4217-a6a4-5a4e552e9177" IsParent="false" Name="Otros" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="6c832201-4c6b-f6c8-e8b5-95b24b9acf15" IsParent="false" Name="NumRef" SeqNo="300" IsActive="true">
        <ColumnSQL><![CDATA['-'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="dc755494-1482-0f1d-399f-94d9224a9d5e" IsParent="false" Name="campo12" SeqNo="130" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a57b90d9-0301-e69f-8198-e190d883e100" Identifier="fa062a80-e392-94c3-b3c0-b7d5136f4fd7" IsParent="false" Name="Monto" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2e3cdd4-6c06-4ad2-90fd-87fc0f8a6cc4" Identifier="b333bda4-40dc-4733-9189-0117a0cece6b" IsParent="false" Name="Deducciones" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="6ba912b2-1451-bf78-4b41-27cad9bc46db" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="9d84ff35-a6fe-d872-ce19-b601db760792" IsParent="false" Name="Total" SeqNo="230" IsActive="true">
        <ColumnSQL><![CDATA[CurrencyConvert(((Select sum(linetotalamt) From c_invoiceline il Where il.C_Invoice_ID= $P{TABLE}.C_Invoice_ID and C_Tax_ID=1000096)*100.00/18.00 + $P{TABLE}.grandtotal), $P{TABLE}.C_Currency_ID, 308, $P{TABLE}.dateinvoiced, $P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8aa3c792-6bad-c926-94ba-5273be2c68fb" Identifier="b7fc9b46-ce69-1df8-420e-d95d5ea2d223" IsParent="false" Name="Correativo+tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right((coalesce(min(case when left($P{TABLE}.fact_id,2)='08' then ($P{TABLE}.fact_id) end),min(case when left($P{TABLE}.fact_id,2) !='08' then ($P{TABLE}.fact_id) end))),9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="8160530a-3069-4132-9bbe-6b358c89d7dd" IsParent="false" Name="FechaEmision" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[to_char(dateinvoiced,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="0b13cc95-9839-4196-532b-195cb32c2928" IsParent="false" Name="TipoIDProv" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA[CASE WHEN (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'R' then '6'  when (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'D' then '1' else  0 end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="41c8b837-12ba-0737-d7bb-404e4ec6b7de" Identifier="48330c64-1cc2-4d20-8be9-69a4b5468cfb" IsParent="false" Name="Saldo" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[round((sum($P{TABLE}.amtacctdr)-sum($P{TABLE}.amtacctcr)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="d151a4f8-f1a9-9791-f7ed-b494310d4198" Identifier="e5cae829-a0a5-dfd9-e616-37adc87b9aa4" IsParent="false" Name="RUC" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.valuebp)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="1ae97241-6ecd-4ac8-aa58-ba3c420f50f6" IsParent="false" Name="Catalogo" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA['9'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="d564628b-61ea-46c5-931c-3a3fe930471d" IsParent="false" Name="TotalSaldo" SeqNo="250" IsActive="true">
        <ColumnSQL><![CDATA[round(($P{TABLE}.saldoprecio),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="75ae8d7c-181e-ecbb-631d-2568a08b0ce1" IsParent="false" Name="Fech.Vcto." SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="b265587a-c3f1-0b38-664e-97741ac150af" IsParent="false" Name="Fech.emision" SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA[to_char(datetrx,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="3d08cde2-66c6-bac8-8a8f-4d30439f19d6" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="25770949-4250-5d81-78b4-54fc480906b9" IsParent="false" Name="SerieRef" SeqNo="290" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad(serial,4,'0') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="2ac55dcb-50cc-c7c9-b91f-3dfd8eb5a5e6" Identifier="1bc5faa8-c8e3-3e02-f07b-1ac7d3d42ff6" IsParent="false" Name="Haber" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[round((case when ((sum($P{TABLE}.amtacctcr))-sum($P{TABLE}.amtacctdr))> 0 then((sum($P{TABLE}.amtacctcr))-sum($P{TABLE}.amtacctdr))else 0 end),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="0ee105e0-f7d7-4fb2-a03d-c4947a814ff8" IsParent="false" Name="direccion" SeqNo="200" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="e8d3adaa-5a75-4a4f-93f3-9105eed67514" IsParent="false" Name="TotalIngreso" SeqNo="190" IsActive="true">
        <ColumnSQL><![CDATA[round(($P{TABLE}.ingresotot),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="314476be-3c84-d287-28ff-9acd253ae6a1" IsParent="false" Name="Glosa" SeqNo="160" IsActive="true">
        <ColumnSQL><![CDATA[regexp_replace(description, '[^\w]+', '', 'g')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="f333ac3c-d058-4f1e-b139-1af6acf9ba73" IsParent="false" Name="Estado" SeqNo="360" IsActive="true">
        <ColumnSQL><![CDATA['0'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="3b4d4241-7c86-b5d8-ad7f-191c9102e57b" IsParent="false" Name="Cod.Unid.Ope" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="baa73cfa-1c18-f23e-a2d2-12346d5ab3c1" IsParent="false" Name="Fech.Emision" SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA[to_char(datetrx,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="01e6e05f-08c2-4dbf-edf8-3b366753be40" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="ce8a87b9-e3cf-e68f-a9cb-3f696ec371cf" IsParent="false" Name="FechRef" SeqNo="270" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT to_char(dateinvoiced,'DD/MM/YYYY') FROM c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8d253def-98f6-8607-9ccf-483ed3a5ae31" Identifier="d6dab0ee-676e-4618-a61d-f88a9f6af39a" IsParent="false" Name="TipoDocIdentidad" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxtype)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="4a83a687-a771-a224-1dfa-48156f36d1eb" IsParent="false" Name="campo18" SeqNo="180" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="3d08cde2-66c6-bac8-8a8f-4d30439f19d6" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="6dacde8f-633f-6176-0767-990639253991" IsParent="false" Name="NumRef" SeqNo="300" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad(documentno,20,'') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="f86becfd-0a12-a743-1f2e-c17130b9d389" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="5664a25e-e0c5-4158-b4f2-564c1ef4deb9" Identifier="5d1c3e69-2329-40e5-ae65-759013dc7eec" IsParent="false" Name="Estado" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="da0e1331-1f9c-400e-a369-a9653ada4153" IsParent="false" Name="campo30" SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="8233c620-ca8f-d4d7-eef3-40d232d571d9" IsParent="false" Name="Medio de pago" SeqNo="400" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="62e1f8f0-9fb6-c52d-b35a-e7094b43ae10" IsParent="false" Name="Glosa" SeqNo="160" IsActive="true">
        <ColumnSQL><![CDATA[regexp_replace(description, '[^\w]+', '', 'g')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="78263273-252d-439f-94fe-21679875d110" IsParent="false" Name="Pais" SeqNo="180" IsActive="true">
        <ColumnSQL><![CDATA['9072'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="01e6e05f-08c2-4dbf-edf8-3b366753be40" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="c3b1baa3-4384-2e15-928e-2bae9bb9b1d1" IsParent="false" Name="NumRef" SeqNo="300" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad(documentno,20,'') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="d151a4f8-f1a9-9791-f7ed-b494310d4198" Identifier="e899a57c-bd6b-d221-82b9-8a6c5b5904c1" IsParent="false" Name="Razon Social" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.namebp)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="9b7b5800-7d77-4610-a0ec-8790729c2303" IsParent="false" Name="Fecha" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[to_char(($P{TABLE}.movementdate),'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="46aa4be2-9af1-fcc3-e7a6-bcefcbdc3d25" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="68905ef0-a60c-d80a-70b0-669b12cd8f33" IsParent="false" Name="FechRef" SeqNo="260" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT to_char(dateinvoiced,'DD/MM/YYYY') FROM c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="d3070934-2364-74c7-32a0-3bdecd98fabb" IsParent="false" Name="campo14" SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="9fe88c38-925b-8dcf-5122-492d103e7683" IsParent="false" Name="FechRef" SeqNo="260" IsActive="true">
        <ColumnSQL><![CDATA['01/01/0001'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="113c8cb8-c18c-d7ee-da55-6fe74f89406a" IsParent="false" Name="Numero de comprobante de pago" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.invoicedocumentno)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="ff0b8cb9-b65d-6bb3-4ebc-9778225e31bd" IsParent="false" Name="Acreedor" SeqNo="190" IsActive="true">
        <ColumnSQL><![CDATA[round(amtacctcr,2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="81bb7588-bd12-e2f9-0ba0-99f127585e99" Identifier="19974354-a3de-4989-81e4-2f27cf5c3a9b" IsParent="false" Name="CostoTotal" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="e73b53f9-ce7c-a2f5-481b-932d035cb776" Identifier="21d2f092-c394-4a09-8021-23fcf9df117e" IsParent="false" Name="Cod.Titulo" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA['0'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="d2c431d6-82fd-2f90-1186-15f3ae1b4d5a" IsParent="false" Name="campo39" SeqNo="390" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="f4501d04-f5ad-7c16-e05f-1a51f81b0fa4" IsParent="false" Name="Cuenta" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT zz.Value FROM C_ElementValue zz  WHERE zz.C_ElementValue_ID=Fact_Acct.account_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="2ac55dcb-50cc-c7c9-b91f-3dfd8eb5a5e6" Identifier="c7434eea-9c5d-df10-1b88-d3fd496dab26" IsParent="false" Name="Moneda" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.currencytax)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c8ed8dca-c62a-6a45-9710-a013ab04f0f9" Identifier="8ff7c366-524b-6377-88a2-56938b3725d0" IsParent="false" Name="TipoDocIdentidad" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxtype)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="d974921c-a7d2-4f88-9e4c-616fcfba6886" IsParent="false" Name="TipoComprobante" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[(select codsunat from c_doctype  where c_doctype_id = $P{TABLE}.c_doctype_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="d4ddc6be-43d9-2a52-0528-33198e13a56d" IsParent="false" Name="Inconsistencia TC" SeqNo="320" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="f546bc03-aad0-2984-b6a8-8f1b91d21875" IsParent="false" Name="Numer de serie" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,4,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="18988374-540c-c762-5c2f-87a085050605" Identifier="967c383a-6644-8919-4303-a5a32239d0f9" IsParent="false" Name="Monto" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="59cd88cc-31cc-c598-3188-f6b1e598fe32" IsParent="false" Name="Moneda" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[(select iso_code from c_currency  where c_currency_id = $P{TABLE}.c_currency_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="81bb7588-bd12-e2f9-0ba0-99f127585e99" Identifier="d5fbd1a4-ea62-44e5-bfd8-7cc1bdb46dae" IsParent="false" Name="Estado" SeqNo="120" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="81bb7588-bd12-e2f9-0ba0-99f127585e99" Identifier="f21c621a-7732-4428-94a3-778e6a77c183" IsParent="false" Name="UnidadMedida" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.um)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="0bfcf63c-33a9-c1ce-02fd-930579e15a91" IsParent="false" Name="NroDoc" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[lpad(($P{TABLE}.documentno::numeric)::character varying,20,' ')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="0b475f00-443c-95cb-bf6b-afbc2f8bfc8f" IsParent="false" Name="Fecha" SeqNo="130" IsActive="true">
        <ColumnSQL><![CDATA[to_char(dateacct,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c8ed8dca-c62a-6a45-9710-a013ab04f0f9" Identifier="72be3651-8b3e-a20a-b794-a912673c44bb" IsParent="false" Name="DocIdentidadSocio" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxid)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="f383a08d-e16f-4db3-be5e-d7b231c512f2" IsParent="false" Name="SaldoDebe" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[round((case when (SUM($P{TABLE}.debe_f) - SUM($P{TABLE}.haber_f))>0 then (SUM($P{TABLE}.debe_f) - SUM($P{TABLE}.haber_f)) else 0 end),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="5621a39e-2b96-41cb-8868-4db11fc6bc6f" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c240f167-8422-e009-279b-ffcf85fdaf77" Identifier="9c6f9655-a969-47a0-be56-34c464bf1491" IsParent="false" Name="Correlativo+tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right((coalesce(min(case when amtacctdr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctdr < 0 then ($P{TABLE}.fact_id) end))),9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="01e6e05f-08c2-4dbf-edf8-3b366753be40" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="a9210a96-9a22-4b01-cc7c-93e42ff25775" IsParent="false" Name="NumRef" SeqNo="300" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad(documentno,20,'') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="8e6f85ea-ac38-4839-8013-b48d86d81a66" IsParent="false" Name="Corr + tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right(fact_id,9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="c9da574f-1850-d674-3d8b-6f188d9f7583" IsParent="false" Name="FechaRef." SeqNo="260" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT to_char(dateinvoiced,'DD/MM/YYYY') FROM c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="0d5b8ae7-43e7-933c-57f2-b1264ce3119a" IsParent="false" Name="Campo18" SeqNo="180" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="f92cfbe8-1645-874c-1da4-5ba1517f33aa" IsParent="false" Name="Estado" SeqNo="340" IsActive="true">
        <ColumnSQL><![CDATA[(case when  $P{TABLE}.docstatus='VO' then '2' when EXTRACT(year from  $P{TABLE}.dateinvoiced) = EXTRACT(year from  $P{TABLE}.dateacct) then '1' when EXTRACT(month from  $P{TABLE}.dateinvoiced) = EXTRACT(month from  $P{TABLE}.dateacct) then '1' when EXTRACT(month from  $P{TABLE}.dateinvoiced) < EXTRACT(month from $P{TABLE}.dateacct) then '8' when EXTRACT(year from  $P{TABLE}.dateinvoiced) < EXTRACT(year from  $P{TABLE}.dateacct) then '8' else 'otro' end)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="a5ee9b33-24ab-4c51-853c-9229e7e99a79" IsParent="false" Name="CantidadSalida" SeqNo="200" IsActive="true">
        <ColumnSQL><![CDATA[round(($P{TABLE}.salidaqty),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="b1c4d30a-3c92-4f8e-decd-5079851a8ef8" IsParent="false" Name="acreedor" SeqNo="170" IsActive="true">
        <ColumnSQL><![CDATA[round(amtacctdr,2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="41c8b837-12ba-0737-d7bb-404e4ec6b7de" Identifier="23624a1a-3860-486a-a7d6-4b5c6f8cf89d" IsParent="false" Name="estado" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="01e6e05f-08c2-4dbf-edf8-3b366753be40" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="51be3678-86fd-79cd-7b77-8420f0bf4b14" IsParent="false" Name="SerieRef" SeqNo="290" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad(serial,4,'0') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="1b26c44e-aa6e-708f-3307-f76ec5c64f3f" IsParent="false" Name="Campo22" SeqNo="220" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="06d697c8-292b-a4d9-ce72-b5ba5f45d2e4" IsParent="false" Name="campo23" SeqNo="230" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="76cb65a0-8061-498e-9cbb-f66ddc36b937" IsParent="false" Name="Estado" SeqNo="180" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="97d9c666-20e8-4bbc-9210-d54d69759c3d" IsParent="false" Name="Campo 10" SeqNo="120" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="08bbc378-8787-7ad0-43d4-c48d2919e93c" IsParent="false" Name="Numero" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[lpad(($P{TABLE}.documentno::numeric)::character varying,20,' ')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="de85662c-7137-447b-834b-4d4b65873fa2" IsParent="false" Name="MovHaber" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.haber_m)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="7a621eab-4679-40dd-16f9-74c5148d6fcb" IsParent="false" Name="Campo16" SeqNo="160" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="e956dcac-d2ca-4ae7-2bf9-2054d32a7bc5" IsParent="false" Name="campo121" SeqNo="130" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="5d835dca-3725-04d6-7d1f-c9d6dd4e5e5c" IsParent="false" Name="Glosa" SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.description)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="4a14c612-39a9-b8dd-0a46-a1f2074560e6" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="c043b1d2-ada1-ecec-2a54-178672048e55" IsParent="false" Name="NumRef" SeqNo="300" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad(documentno,20,'') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c8ed8dca-c62a-6a45-9710-a013ab04f0f9" Identifier="f85219b8-a478-036b-230f-b0b16c2d715b" IsParent="false" Name="Cuenta" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.valueacct)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2e3cdd4-6c06-4ad2-90fd-87fc0f8a6cc4" Identifier="8d5114f9-d44f-4f1b-a339-95a883a1d06d" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[coalesce(min(case when amtacctcr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctcr < 0 then ($P{TABLE}.fact_id) end))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="5664a25e-e0c5-4158-b4f2-564c1ef4deb9" Identifier="d32284db-94f6-4e3c-b6e1-66a126b80bc8" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="96625f8a-7dbe-4499-a249-485340f320eb" IsParent="false" Name="TipoExistencia" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.producttypetax)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="6f071a5b-44a8-0b49-1d32-4880201ce683" IsParent="false" Name="Cod.Centro Costo" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="81bb7588-bd12-e2f9-0ba0-99f127585e99" Identifier="909e8aa4-b719-44f1-9a67-4a615c92cc66" IsParent="false" Name="Cantidad" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[round(sum($P{TABLE}.qty),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="880b3dd1-0622-bcd7-f23e-b0ef67502ec5" IsParent="false" Name="SerieRef" SeqNo="280" IsActive="true">
        <ColumnSQL><![CDATA['-'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="4c713835-45bb-29d8-84c1-42fe394b0eb3" Identifier="37b9f00d-d346-02bb-6b20-170e41bb53ac" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c240f167-8422-e009-279b-ffcf85fdaf77" Identifier="952f336e-dddd-4606-8e61-5971b6920139" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[coalesce(min(case when amtacctdr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctdr < 0 then ($P{TABLE}.fact_id) end))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="f9fe6e66-3cb6-bf07-1470-f23f09d3bbcd" Identifier="97d47863-f4c9-abeb-8cc4-e98c44a5e971" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="5664a25e-e0c5-4158-b4f2-564c1ef4deb9" Identifier="2eb4f910-bf10-4fb5-8718-5f4aaa653d09" IsParent="false" Name="Nombre" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA[left($P{TABLE}.name,100)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="e28864d9-da24-c951-a372-5415ccc1a772" IsParent="false" Name="deudor" SeqNo="160" IsActive="true">
        <ColumnSQL><![CDATA[round(amtacctcr,2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="8c42a4f6-0604-49b8-90bf-b1bbd5df0830" IsParent="false" Name="Numero" SeqNo="120" IsActive="true">
        <ColumnSQL><![CDATA[lpad(( ($P{TABLE}.documentno )::numeric)::character varying,20,' ')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c8ed8dca-c62a-6a45-9710-a013ab04f0f9" Identifier="85ae87b7-d149-e49c-af73-19b9c34808c8" IsParent="false" Name="Correlativo+tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right((coalesce(min(case when amtacctcr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctdr > 0 then ($P{TABLE}.fact_id) end))),9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8d253def-98f6-8607-9ccf-483ed3a5ae31" Identifier="fa854c9b-d3bb-4a08-b62b-ef89638e4f56" IsParent="false" Name="DocIdentidadSocio" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxid)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="01e6e05f-08c2-4dbf-edf8-3b366753be40" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="6461acd5-22c7-8f00-ba99-76171c891492" IsParent="false" Name="SerieRef" SeqNo="290" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad(serial,4,'0') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="4c713835-45bb-29d8-84c1-42fe394b0eb3" Identifier="3cb73164-1060-8b77-d5fb-78dd5a5c215e" IsParent="false" Name="Monto" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.amtacctcr) - SUM($P{TABLE}.amtacctdr)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="8804903e-e2d0-46af-9452-27b6b632535e" IsParent="false" Name="BalanceHaber" SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[round((case when (SUM($P{TABLE}.pasivo_b) - SUM($P{TABLE}.activo_b))>0 then (SUM($P{TABLE}.pasivo_b) - SUM($P{TABLE}.activo_b)) else 0 end),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1d81ccef-0699-4065-8898-b6263b549f33" Identifier="5da81258-9758-442d-88fd-fc07cc2cdbbb" IsParent="false" Name="TipoDoc" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[(CASE WHEN (select c_bp_doctypei from c_bpartner where $P{TABLE}.c_bpartner_id  = c_bpartner_id) = 'R'::bpchar THEN 6 WHEN (select c_bp_doctypei from c_bpartner where $P{TABLE}.c_bpartner_id  = c_bpartner_id) = 'D'::bpchar THEN 1 ELSE 0 END)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="d151a4f8-f1a9-9791-f7ed-b494310d4198" Identifier="224e3e58-e137-b2c1-1b10-381c1e7b1cd0" IsParent="false" Name="Descripcion" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.description)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="4c0b4bc8-45e7-05ee-958f-30999c62307a" IsParent="false" Name="Corr + tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right(fact_id,9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="aeb8daa3-80ee-4c6e-beab-73b482a9f405" IsParent="false" SeqNo="300" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="183917af-ef19-0edc-e82c-469256b5fb8b" IsParent="false" Name="TipRef" SeqNo="280" IsActive="true">
        <ColumnSQL><![CDATA['00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="150145df-1fe4-0edc-0c69-d536e248e83b" IsParent="false" Name="Estado" SeqNo="410" IsActive="true">
        <ColumnSQL><![CDATA[case when EXTRACT(year from $P{TABLE}.dateinvoiced) = EXTRACT(year from $P{TABLE}.dateacct) then (case when EXTRACT(month from $P{TABLE}.dateinvoiced) = EXTRACT(month from $P{TABLE}.dateacct) then '1' when EXTRACT(month from $P{TABLE}.dateinvoiced) < EXTRACT(month from $P{TABLE}.dateacct) then '6' else 'otro' end) when EXTRACT(year from $P{TABLE}.dateacct) - EXTRACT(year from $P{TABLE}.dateinvoiced) = 1 then (case when EXTRACT(month from $P{TABLE}.dateinvoiced) >= EXTRACT(month from $P{TABLE}.dateacct) then '6' else '7' end) when EXTRACT(year from $P{TABLE}.dateacct) - EXTRACT(year from $P{TABLE}.dateinvoiced) >1 then '7' else 'otro' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="fbb96344-1944-4d5b-b9e1-e832039f2bfc" IsParent="false" Name="Estado" SeqNo="260" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="18988374-540c-c762-5c2f-87a085050605" Identifier="e65f5b81-ace3-0240-d793-fba0a0166122" IsParent="false" Name="DocIdentidadSocio" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxid)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c240f167-8422-e009-279b-ffcf85fdaf77" Identifier="48d929bc-b08a-499d-a9ce-37b84226095d" IsParent="false" Name="Valor contable" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="fe038c9e-3dd5-43db-8a15-0e58bf1c4c4f" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1d81ccef-0699-4065-8898-b6263b549f33" Identifier="a0a7c4af-75fc-41f7-b0d8-67d99260a3a9" IsParent="false" Name="Numero acciones" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[round(($P{TABLE}.shares),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="4a14c612-39a9-b8dd-0a46-a1f2074560e6" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="9b19dedc-cdbe-4c27-542a-d2126d5625a0" IsParent="false" Name="FechRef" SeqNo="260" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT to_char(dateinvoiced,'DD/MM/YYYY') FROM c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="c9a5ac83-6e4a-b071-4a7b-df363d39221c" IsParent="false" Name="Tip.Comprobante" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[(case when $P{TABLE}.isdistribution = 'Y' then '00' when $P{TABLE}.ad_table_id = 735 then '00'  when $P{TABLE}.ad_table_id != 735 and coalesce($P{TABLE}.c_doctype_id,0) != 0  then (select codsunat from c_doctype  where c_doctype_id = $P{TABLE}.c_doctype_id) else '00' end)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="e73b53f9-ce7c-a2f5-481b-932d035cb776" Identifier="eab7d5c9-a370-4e81-affa-be1276dd0593" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[coalesce(min(case when amtacctdr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctdr < 0 then ($P{TABLE}.fact_id) end))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="8939e000-83a3-ae8d-f5a0-3d1c00a348c0" IsParent="false" Name="Serie" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,4,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="d151a4f8-f1a9-9791-f7ed-b494310d4198" Identifier="f96ecdc6-c527-b606-71ef-45a320eaa65c" IsParent="false" Name="CtaBancaria" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.accountno)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="81bb7588-bd12-e2f9-0ba0-99f127585e99" Identifier="7a795ca2-8267-4fcf-8133-010c7196a1b1" IsParent="false" Name="CostoUnitario" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[round(((sum($P{TABLE}.amtacctdr)-sum($P{TABLE}.amtacctcr))/case when (sum($P{TABLE}.qty))= 0 then 1 else (sum($P{TABLE}.qty)) end),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="dac7318d-9022-808c-f59c-161793f51955" IsParent="false" Name="Fecha" SeqNo="130" IsActive="true">
        <ColumnSQL><![CDATA[to_char(dateacct,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="4459cbe3-a1e8-0c35-62e3-3d4622179172" IsParent="false" Name="NroCorr" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.fact_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="4a14c612-39a9-b8dd-0a46-a1f2074560e6" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="36208f0a-b52d-410e-c897-0cc517cdca96" IsParent="false" Name="SerieRef" SeqNo="280" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad(serial,4,'0') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2e3cdd4-6c06-4ad2-90fd-87fc0f8a6cc4" Identifier="8591b416-4d1f-48ca-bccc-216c27180d94" IsParent="false" Name="Saldo" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[round(sum($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="d5c90a77-019a-d62d-961c-347cfbdc97fd" IsParent="false" Name="Fechdetraccion" SeqNo="310" IsActive="true">
        <ColumnSQL><![CDATA[case when $P{TABLE}.isdetraction='Y' then  to_char(datedetraction,'DD/MM/YYYY')  else '01/01/0001' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="3d08cde2-66c6-bac8-8a8f-4d30439f19d6" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="f84cde25-e93d-99f8-f644-21af36f80e36" IsParent="false" Name="TipRef" SeqNo="280" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT codsunat from c_doctype where c_doctype_id in (SELECT c_doctype_id  from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="097800d4-c59e-4bf1-87f0-2e283b43d1ba" IsParent="false" Name="FechaVcto" SeqNo="130" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="18988374-540c-c762-5c2f-87a085050605" Identifier="ccb91b4d-b3ce-e028-cb46-717ddc75f3d5" IsParent="false" Name="Fecha" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[to_char(min($P{TABLE}.datetrx),'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="c6d66183-a3a1-6567-8201-59d4fda90ca1" IsParent="false" Name="FechaEmision" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[to_char(dateinvoiced,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a57b90d9-0301-e69f-8198-e190d883e100" Identifier="d4e988d3-25e1-ae87-7e81-ddbb29a2d1a8" IsParent="false" Name="Nombre" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.namebp)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="a1a81289-2ed3-5ffd-f96e-0382fb926a4c" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="c070a7a1-b748-93b3-fab3-a62e759a1244" IsParent="false" Name="IGV" SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA[CurrencyConvert((Select sum(linetotalamt) From c_invoiceline il Where il.C_Invoice_ID= $P{TABLE}.C_Invoice_ID and C_Tax_ID=1000096), $P{TABLE}.C_Currency_ID, 308, $P{TABLE}.dateinvoiced, $P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c8ed8dca-c62a-6a45-9710-a013ab04f0f9" Identifier="419347bc-d334-51fc-4a91-349e21b242cb" IsParent="false" Name="Fecha" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[to_char(min($P{TABLE}.datetrx),'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="264b5148-bd42-75ed-6c0e-3a494de78bc4" IsParent="false" Name="AnioDUA" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="9e3c5d31-eb3f-8cdf-3f0b-b75bccc8815c" IsParent="false" Name="TipRef" SeqNo="270" IsActive="true">
        <ColumnSQL><![CDATA['00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2e3cdd4-6c06-4ad2-90fd-87fc0f8a6cc4" Identifier="e14f8690-d623-4505-b02f-79a315f40b67" IsParent="false" Name="Correlativo+tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right((coalesce(min(case when amtacctcr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctcr < 0 then ($P{TABLE}.fact_id) end))),9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="ab6aa867-ad0c-4f73-89de-be8d3910b247" IsParent="false" Name="Serie" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,4,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="f9fe6e66-3cb6-bf07-1470-f23f09d3bbcd" Identifier="c9aa461e-b973-fc0f-a466-9a666ea1657d" IsParent="false" Name="Estado" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="b492c1e2-9160-40bd-985d-5356c6b9aae8" IsParent="false" Name="Total" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[CurrencyConvert($P{TABLE}.grandtotal,$P{TABLE}.C_Currency_ID, 308, $P{TABLE}.dateinvoiced, $P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="05a34c0b-7e0f-3278-4096-bd95843da8a8" IsParent="false" Name="Docdetraccion" SeqNo="320" IsActive="true">
        <ColumnSQL><![CDATA[case when $P{TABLE}.isdetraction='Y' then $P{TABLE}.docdetraction else '0' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="a1a955c6-6a78-5b5d-5261-d1e4d228530d" IsParent="false" Name="Serie" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,4,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="81bb7588-bd12-e2f9-0ba0-99f127585e99" Identifier="c2932e4b-4035-4d52-aa4f-9db4a969bf80" IsParent="false" Name="Catalogo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA['9'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="cabb050b-d99b-3f0a-fa1e-5c348f7bf3a2" IsParent="false" Name="BaseGravada" SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[case when gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'IGV'::text, 'BASE'::text)!=0 then round(gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'IGV'::text, 'BASE'::text),2) else '0.00' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="8e48d205-4b8a-f948-3a37-75557dac2654" IsParent="false" Name="Campo29" SeqNo="290" IsActive="true">
        <ColumnSQL><![CDATA[' '::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1d81ccef-0699-4065-8898-b6263b549f33" Identifier="6e373374-46e6-49e4-b4e2-2c519d8133ec" IsParent="false" Name="Tipo de accion" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT value FROM ad_ref_list refl where refl.ad_reference_id = 1000099 and $P{TABLE}.taxid = refl.value)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="d2af06b4-f532-4523-b5dc-4362d4d1ea5d" IsParent="false" Name="SaldoIniDebe" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.debe_i)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="095f6de7-969e-3b53-df9e-5fa9f29c6ce0" IsParent="false" Name="Campo21" SeqNo="210" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="c954ce19-dd28-821d-eaa0-8bd2ba978089" IsParent="false" Name="SerieRef" SeqNo="280" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad(serial,4,'0') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="dd250626-5c5b-50e5-4dc0-39b006082dd2" IsParent="false" Name="Cuenta" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT zz.Value FROM C_ElementValue zz  WHERE zz.C_ElementValue_ID=Fact_Acct.account_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="e33cb3ae-e4bb-442a-ff71-df544696fd13" IsParent="false" Name="NumRef" SeqNo="300" IsActive="true">
        <ColumnSQL><![CDATA['-'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8d253def-98f6-8607-9ccf-483ed3a5ae31" Identifier="64a1984b-2718-48dc-97c3-78eb7f31dda5" IsParent="false" Name="Nombre" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.namebp)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2e3cdd4-6c06-4ad2-90fd-87fc0f8a6cc4" Identifier="4d1606f3-e59d-4cc3-aa4d-61d26036e603" IsParent="false" Name="serie" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,4,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c240f167-8422-e009-279b-ffcf85fdaf77" Identifier="6267961e-83e4-41db-a300-aa0fffd99ae8" IsParent="false" Name="Fecha" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[to_char(min($P{TABLE}.datetrx),'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="291eb29b-05ca-479f-bbba-7b1b2e9d37ff" IsParent="false" Name="Pais" SeqNo="240" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="576e6331-7b6c-1773-9e39-19f6d5c3039d" IsParent="false" Name="Fech.Emision" SeqNo="130" IsActive="true">
        <ColumnSQL><![CDATA[to_char(datetrx,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="ced97088-b6c4-57f3-d262-a0ed9efbab36" IsParent="false" Name="Moneda" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[(select iso_code from c_currency  where c_currency_id = $P{TABLE}.c_currency_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="e1cbfe28-59e0-98c7-08a1-bdbfd014d683" IsParent="false" Name="Glosa Ref" SeqNo="170" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="ac4ea664-38a9-7567-e943-039f52ddd8d3" IsParent="false" Name="estado" SeqNo="210" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8aa3c792-6bad-c926-94ba-5273be2c68fb" Identifier="eb0bd2fd-2547-7e36-748e-f2e250e248b0" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[coalesce(min(case when left($P{TABLE}.fact_id,2)='08' then ($P{TABLE}.fact_id) end),min(case when left($P{TABLE}.fact_id,2)!='08' then ($P{TABLE}.fact_id) end))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="c18b1a16-9fe7-4ec7-8d31-d50c167d06f7" IsParent="false" Name="TotalSalida" SeqNo="220" IsActive="true">
        <ColumnSQL><![CDATA[round(($P{TABLE}.salidatot),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="124ebe9f-38d5-28a9-c76c-882beabd5ef4" IsParent="false" Name="periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2e3cdd4-6c06-4ad2-90fd-87fc0f8a6cc4" Identifier="6683cce7-44fe-416d-97b4-1a69af93447f" IsParent="false" Name="Cuenta" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.valueacct)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="3b1b7710-e495-4ae4-903e-7cf0adbea016" IsParent="false" SeqNo="260" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="4332208f-bc81-486c-945a-f403a9563e5a" IsParent="false" Name="campo28" SeqNo="220" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="2ac55dcb-50cc-c7c9-b91f-3dfd8eb5a5e6" Identifier="fd025072-df9b-67ab-213d-284bed6c94c4" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="39c999c4-072e-eb6f-63a9-8dac5cd7237f" IsParent="false" Name="Retencion" SeqNo="330" IsActive="true">
        <ColumnSQL><![CDATA[case when (SELECT max(c_invoice_id) from c_retention r where r.c_invoice_id = $P{TABLE}.c_invoice_id) = $P{TABLE}.c_invoice_id  then '1' else '  ' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="c8b175a4-731a-8f7a-88d7-eedc2a3389fa" IsParent="false" Name="SerieRef" SeqNo="280" IsActive="true">
        <ColumnSQL><![CDATA['-'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="c49c8213-e4a8-4b2b-8eed-ce979edd3634" IsParent="false" Name="SaldoIniHaber" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[round((SUM($P{TABLE}.haber_i)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="a88e3c30-b83f-478a-bb4d-7858624f6b9b" IsParent="false" Name="CostoSalida" SeqNo="210" IsActive="true">
        <ColumnSQL><![CDATA[round(($P{TABLE}.costo),4)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="a1a81289-2ed3-5ffd-f96e-0382fb926a4c" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="2ebe6c11-bc2d-a60e-88b0-63967ab7af44" IsParent="false" Name="BaseGravada" SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[CurrencyConvert(((Select sum(linetotalamt) From c_invoiceline il Where il.C_Invoice_ID= $P{TABLE}.C_Invoice_ID and C_Tax_ID=1000096)*100.00/18.00), $P{TABLE}.C_Currency_ID, 308, $P{TABLE}.dateinvoiced, $P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="27a5a643-73ae-90c2-b287-0bab482b6709" IsParent="false" Name="Cod.Unid.Ope" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8d253def-98f6-8607-9ccf-483ed3a5ae31" Identifier="790c102d-1c34-4ab0-aa39-71dd6521dc73" IsParent="false" Name="Serie" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,4,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="8818617a-35ec-6a18-b31d-9f729980e6f2" IsParent="false" Name="Campo38" SeqNo="380" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="4c713835-45bb-29d8-84c1-42fe394b0eb3" Identifier="f6ac912a-823a-b64a-25e6-f2a5c8e6091e" IsParent="false" Name="Estado" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="1ed5dc36-67a6-8cc9-9ef4-219d517d08cc" IsParent="false" Name="Fecha Contable" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA[to_char(dateacct,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="d3a25216-08ec-a5df-effd-720c0961c36e" IsParent="false" Name="Proveedor" SeqNo="130" IsActive="true">
        <ColumnSQL><![CDATA[(select name from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="29450160-1043-fa80-ef04-9b4080e8b7d3" IsParent="false" Name="Cod.Centro Costo" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" ColumnName="serial" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="6660e94f-8b60-0e21-c1c4-92bfaf8872a1" IsParent="false" Name="Serie" SeqNo="110" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="c3a2be11-a483-ad7c-d410-54ce625fd6b1" IsParent="false" Name="campo21" SeqNo="210" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="e0f3ae62-7d16-e773-4717-fc3eb092308a" IsParent="false" Name="TipDoc" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[CASE WHEN (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'R' then '6'  when (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'D' then '1' else  0 end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="7002dbc9-b93c-4fc8-88c9-800b1f58e007" IsParent="false" Name="UnidadDe medida" SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.um)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="c40972bb-5caf-414b-185e-343216e636f3" IsParent="false" Name="FechaVcto" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="6b5f2786-71d9-cb25-5345-78c9df49b887" IsParent="false" Name="acreedor" SeqNo="190" IsActive="true">
        <ColumnSQL><![CDATA[round(amtacctcr,2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="c4916ec6-296e-a4a5-9e73-722496ef2674" IsParent="false" Name="Docdetraccion" SeqNo="320" IsActive="true">
        <ColumnSQL><![CDATA[case when $P{TABLE}.isdetraction='Y' then $P{TABLE}.docdetraction else '0' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="de2d206b-f77b-6a61-3faa-20d630bc76fd" IsParent="false" Name="campo15" SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="81bb7588-bd12-e2f9-0ba0-99f127585e99" Identifier="52693628-815a-4953-a32c-1a6e98134c21" IsParent="false" Name="CatExistencia" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="76b04a26-a84d-4570-8682-2cca68783082" IsParent="false" Name="CatExistencia" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1d81ccef-0699-4065-8898-b6263b549f33" Identifier="f421ffc6-900c-494c-8190-43d87fb11bb5" IsParent="false" Name="Nombre" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[(select name from c_bpartner where $P{TABLE}.c_bpartner_id  = c_bpartner_id )]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="fd6a5b70-d64c-6833-9d37-06baad955ebb" IsParent="false" Name="FechaEmisi9on" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[to_char(dateinvoiced,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="6d58bd8c-1217-145a-8acc-a424d1706850" IsParent="false" Name="FechVcto" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="4c713835-45bb-29d8-84c1-42fe394b0eb3" Identifier="c6dc953b-e82d-0801-8401-0d838be95a9f" IsParent="false" Name="Codigo trabajador" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[left(($P{TABLE}.user),11)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="a8fe9925-bad4-ba79-31ce-bf221469055b" IsParent="false" Name="Tip.Comp." SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[(select codsunat from c_doctype  where c_doctype_id = $P{TABLE}.c_doctype_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="b400dafa-3168-4101-8856-81f198d69749" Identifier="cf79592e-643a-401b-b551-4cefe7ab8458" IsParent="false" Name="NumAcciones" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[round((max($P{TABLE}.shares)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="bc3d1ab3-9a1d-d218-940c-c4a597170695" IsParent="false" Name="BaseGravada" SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[case when gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'IGV'::text, 'BASE'::text)!=0 then round(gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'IGV'::text, 'BASE'::text),2) else '0.00' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="d151a4f8-f1a9-9791-f7ed-b494310d4198" Identifier="ca047834-386e-b74c-612d-508b49d6a194" IsParent="false" Name="Entidad bancaria" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.routingno)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="98275d60-fae7-06de-f48d-44e9af98fa40" IsParent="false" Name="acreedor" SeqNo="190" IsActive="true">
        <ColumnSQL><![CDATA[round(amtacctcr,2]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="71c991d6-ef1d-d7a2-61c9-42d71d2b274a" IsParent="false" Name="Campo35" SeqNo="350" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="f61f878c-1e1a-2a73-dc5a-59fb0f7d1535" IsParent="false" Name="Corr + tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right(fact_id,9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="7af9b0c3-f126-436b-94a9-c2ee5c7d9024" IsParent="false" Name="TransfHaber" SeqNo="120" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="25e25ea7-3f53-ea73-e1e9-f3706cd4e7ea" Identifier="4b21d7bb-7806-4daa-86b3-01cd7c6413b9" IsParent="false" Name="Catalogo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA['01'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="60226bf0-24cb-4897-bf81-962ac6a7843d" IsParent="false" Name="TipoDoc" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.documenttype)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" ColumnName="fact_id" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="0504df00-87fa-e9eb-086c-9ec243542a85" IsParent="false" Name="Libro" SeqNo="200" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="b400dafa-3168-4101-8856-81f198d69749" Identifier="2f409d9c-4dc2-43cd-a4f3-c957963be9fc" IsParent="false" Name="NumAccionesPagadas" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[round((max($P{TABLE}.paid_up_shares)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="46aa4be2-9af1-fcc3-e7a6-bcefcbdc3d25" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="60aeb2b2-914b-02ab-1c64-29d66bfb44cb" IsParent="false" Name="TipRef" SeqNo="270" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT codsunat from c_doctype where c_doctype_id in (SELECT c_doctype_id  from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="220c0d03-cc59-64dd-b40e-683e2660b673" IsParent="false" Name="Total" SeqNo="240" IsActive="true">
        <ColumnSQL><![CDATA[(case when $P{TABLE}.docstatus = 'CO' then (CurrencyConvert($P{TABLE}.grandtotal,$P{TABLE}.C_Currency_ID, 308, $P{TABLE}.dateinvoiced, $P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID)) else '0.00' end )]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="dba10a9e-a583-e2a5-6805-20d4f8253615" IsParent="false" Name="campo17" SeqNo="170" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="f14e7c09-8339-39b8-1316-4bd73f04dc5f" IsParent="false" Name="Correlativo + tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA[(case when isopendocument = 'Y' then 'A' ELSE (case when isclosedocument = 'Y' then 'C' else 'M' end)end)||right((CASE 	WHEN (rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC))::integer >= 10  	THEN (fact_id)::text||'-'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) ELSE (fact_id)::text||'-0'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) 	END),9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="4b507dee-a7cf-1bbb-3773-cdc955829e3a" IsParent="false" Name="Moneda" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[(select iso_code from c_currency  where c_currency_id = $P{TABLE}.c_currency_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="33984a12-44b6-0ad0-2a15-f84baff93df3" IsParent="false" Name="Numero RUC" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[(select taxid from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="a1a81289-2ed3-5ffd-f96e-0382fb926a4c" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="d00f8ea8-8891-71fa-05f9-7a0e7635dc1d" IsParent="false" Name="Serie" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,3,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" ColumnName="Fact_ID" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="420715b8-9865-f4ef-f403-040af560a8dc" IsParent="false" Name="NroCorr" SeqNo="20" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c240f167-8422-e009-279b-ffcf85fdaf77" Identifier="525cfc22-6263-4c7b-86d7-8afe6f878587" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="89668ba2-8d97-d7da-9c55-64af5b4bd15d" IsParent="false" Name="Fech.Emision" SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA[to_char(datetrx,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="d151a4f8-f1a9-9791-f7ed-b494310d4198" Identifier="7732c581-7116-494c-0768-aac5c7966063" IsParent="false" Name="estado" SeqNo="150" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="2ac55dcb-50cc-c7c9-b91f-3dfd8eb5a5e6" Identifier="08c2cb34-9bb3-4dba-3148-0d8420bc612d" IsParent="false" Name="Cuenta" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.valueacct)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="e985a588-994c-1634-7043-e53d7a9f389d" IsParent="false" Name="TipoComprobante" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[(select codsunat from c_doctype  where c_doctype_id = $P{TABLE}.c_doctype_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="87f207b5-c664-8acf-f670-c3041ff7df9b" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="f6ec00ef-fc15-1aa7-1a7e-fd46a338e0dc" IsParent="false" Name="FechaVcto" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[to_char(dateacct,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="2ac55dcb-50cc-c7c9-b91f-3dfd8eb5a5e6" Identifier="7086e257-583f-3d59-0e0c-1b2b2d8e3f03" IsParent="false" Name="Cta bancaria" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.accountno)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a57b90d9-0301-e69f-8198-e190d883e100" Identifier="1669e81f-df90-7e00-6d71-23f9f48a620f" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[coalesce(min(case when amtacctdr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctcr > 0 then ($P{TABLE}.fact_id) end))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" ColumnName="Total" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="26f4b3b9-f3d0-f935-6da6-397277292017" IsParent="false" Name="CurrencyConvert($P{TABLE}.grandtotal,$P{TABLE}.C_Currency_ID" SeqNo="240" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="261f399c-288d-366b-747c-7a077ebd15c1" IsParent="false" Name="Cuenta" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT zz.Value FROM C_ElementValue zz  WHERE zz.C_ElementValue_ID=Fact_Acct.account_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="c722858b-b2f3-4ad1-b2d1-f55620e8c2c9" IsParent="false" Name="Serie" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,4,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="1f9f1c6d-4cd7-4e93-9179-c65c437c4886" IsParent="false" Name="DescripcionProducto" SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.namep)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="cf800177-102d-25c1-c71f-9e2c6b4692a0" IsParent="false" Name="Correlativo + tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA[(case when isopendocument = 'Y' then 'A' ELSE (case when isclosedocument = 'Y' then 'C' else 'M' end)end)||right((CASE  WHEN (rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC))::integer >= 10   THEN (fact_id)::text||'-'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) ELSE (fact_id)::text||'-0'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC))  END),9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="22391a30-842b-35ff-e57b-3b0b5c65a035" IsParent="false" Name="Moneda" SeqNo="250" IsActive="true">
        <ColumnSQL><![CDATA[(select iso_code from c_currency  where c_currency_id = $P{TABLE}.c_currency_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="e75eaea7-f3cc-4634-9d2e-048cbec0ce8a" IsParent="false" SeqNo="350" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="f5d64fef-fe73-dd4f-c0a7-6cd525cea2c3" IsParent="false" Name="FechaEmision" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[to_char(dateinvoiced,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="bf0cbf34-1fe1-b0b8-54be-8820fdded985" IsParent="false" Name="NumRef" SeqNo="300" IsActive="true">
        <ColumnSQL><![CDATA['-'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="18988374-540c-c762-5c2f-87a085050605" Identifier="5e867dd5-ac57-67ef-f36e-97b9191ae9b5" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[coalesce(min(case when amtacctdr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctcr > 0 then ($P{TABLE}.fact_id) end))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="7735a930-8b03-404f-9fa8-fb39c60bcef0" IsParent="false" Name="Catalogo" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA['9'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="01e6e05f-08c2-4dbf-edf8-3b366753be40" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="1740357c-5929-3b0b-7a80-6fb9f73624fc" IsParent="false" Name="TipRef" SeqNo="280" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT codsunat from c_doctype where c_doctype_id in (SELECT c_doctype_id  from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="700f21d0-3459-430b-88e0-5ffa980c97ad" IsParent="false" Name="Base" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[case when gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'NGR'::text, 'BASE'::text) != 0 then gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'NGR'::text, 'BASE'::text) else '0.00' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="53a32d04-933f-4c17-b4f6-0d6eba0b0402" IsParent="false" Name="CantidadSaldo" SeqNo="230" IsActive="true">
        <ColumnSQL><![CDATA[round(($P{TABLE}.saldo),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a57b90d9-0301-e69f-8198-e190d883e100" Identifier="84110886-57ae-688b-46e3-d12acc41d775" IsParent="false" Name="Correlativo+tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right((coalesce(min(case when amtacctdr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctcr > 0 then ($P{TABLE}.fact_id) end))),9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2e3cdd4-6c06-4ad2-90fd-87fc0f8a6cc4" Identifier="eec23c92-fa55-4184-b90b-15f2eb412fb3" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="4075adab-e7e4-4707-834a-abf081ce53d6" IsParent="false" Name="DescripcionProducto" SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.namep)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="fba37490-89cb-f4f3-58b3-da46cecd08ca" IsParent="false" Name="SerieRef" SeqNo="280" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT lpad(serial,4,'0') from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="4c713835-45bb-29d8-84c1-42fe394b0eb3" Identifier="4e036cf1-0259-90ed-c44b-21c4b8225341" IsParent="false" Name="Nombre" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.namebp)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="8042dece-b56f-62d7-3c01-657eba628e04" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA[Generado por PLE]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" ColumnName="description" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="719518d3-9a98-a033-053a-0d10f035819c" IsParent="false" Name="Glosa" SeqNo="160" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="64234b42-cafd-356e-53ca-9ab5cb280fa3" IsParent="false" Name="deudor" SeqNo="180" IsActive="true">
        <ColumnSQL><![CDATA[round(amtacctdr,2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="f9fe6e66-3cb6-bf07-1470-f23f09d3bbcd" Identifier="4f5e22f2-9204-c8d3-42ff-b481538eac36" IsParent="false" Name="Nombre" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.namebp)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="afd6e46b-b7a0-7f9b-e336-1a3d177bc7dc" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="0c20c781-1220-4165-a599-b5e45d5aea7f" IsParent="false" Name="Serie" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,3,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="05a4f566-20f0-b81c-62b8-0380807736fa" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[(CASE WHEN (rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC))::integer >= 10   THEN (fact_id)::text||'-'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) ELSE (fact_id)::text||'-0'||(rank() OVER (PARTITION BY fact_id ORDER BY fact_acct_id DESC)) END)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="1bf63e22-4e46-c467-bd01-a42f28089877" IsParent="false" Name="TipRef" SeqNo="270" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT codsunat from c_doctype where c_doctype_id in (SELECT c_doctype_id  from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="08f85fc3-b6e2-e74c-5f6e-876e1b977e11" IsParent="false" Name="Cod.Unid.Ope" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="65af6e8e-8737-94e5-41a3-aaa9b720d098" IsParent="false" Name="IGV" SeqNo="160" IsActive="true">
        <ColumnSQL><![CDATA[round(gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'IGV'::text, 'IGV'::text),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="b84e0403-a2bc-4511-a37d-219c48345224" IsParent="false" Name="Proveedor" SeqNo="190" IsActive="true">
        <ColumnSQL><![CDATA[(select name from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="6c2a5c79-1ede-1ee7-8199-6d634afffc9a" IsParent="false" Name="Glosa Ref." SeqNo="170" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="5664a25e-e0c5-4158-b4f2-564c1ef4deb9" Identifier="f229b3cb-f5c8-4145-a558-8de25c274903" IsParent="false" Name="Plan de cuentas" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA['01'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="11bf84ec-693c-5090-a050-dd78dd8db96e" IsParent="false" Name="Tip.Doc" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[CASE WHEN (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'R' then '6'  when (select c_bp_doctypei from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id) = 'D' then '1' else  0 end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="2ac55dcb-50cc-c7c9-b91f-3dfd8eb5a5e6" Identifier="5f4eb3b7-1362-93cd-75d3-5c3ef20a9157" IsParent="false" Name="estado" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="78472443-1543-0f9e-e7aa-0f94d5a96ac3" IsParent="false" Name="Campo10" SeqNo="100" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="e32ed1c2-75b0-4ef5-9843-c14fcf2b7d54" IsParent="false" Name="Almacen" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.valuew)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="6ba912b2-1451-bf78-4b41-27cad9bc46db" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="cb395f30-13ab-bd2a-db38-130e4b3026bc" IsParent="false" Name="AnioDUA" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[trim(to_char(extract(year from dateinvoiced),'9999'))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" ColumnName="invoicedocumentno" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="b9338bdf-bde7-429d-3f30-a9e47f92b92a" IsParent="false" Name="Numero" SeqNo="120" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="d151a4f8-f1a9-9791-f7ed-b494310d4198" Identifier="4ab839a5-b34d-e255-8665-f6aaf4751160" IsParent="false" Name="Medio Pago" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.Payment_method)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="666ebe7a-88a8-05e4-588f-7495527ffa03" IsParent="false" Name="Total" SeqNo="230" IsActive="true">
        <ColumnSQL><![CDATA[CurrencyConvert($P{TABLE}.grandtotal,$P{TABLE}.C_Currency_ID, 308, $P{TABLE}.dateinvoiced, $P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="7fa3d5e4-a980-4122-8144-7f989cdd3822" IsParent="false" Name="Numero" SeqNo="120" IsActive="true">
        <ColumnSQL><![CDATA[lpad(( ($P{TABLE}.documentno )::numeric)::character varying,20,' ')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="6fba8709-eb61-4120-9d13-f8c9883f6d68" IsParent="false" Name="Valuacion" SeqNo="160" IsActive="true">
        <ColumnSQL><![CDATA['1'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="8e34f9d7-2142-c8f4-c7d8-52bc0cd7b601" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="00077fe2-4d15-266d-d0a7-cb1e60cdf34c" IsParent="false" Name="Campo36" SeqNo="360" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="9efbb2be-3f08-ad61-8def-6fa599eead2f" IsParent="false" Name="NroRUC" SeqNo="110" IsActive="true">
        <ColumnSQL><![CDATA[(select taxid from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="4ce71189-58b7-8e6d-a8c8-a80902250f3b" IsParent="false" Name="BaseGravada" SeqNo="140" IsActive="true">
        <ColumnSQL><![CDATA[case when gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'IGV'::text, 'BASE'::text)!=0 then round(gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'IGV'::text, 'BASE'::text),2) else '0.00' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="31d76fa0-4ccb-cece-c9ce-29636d55fad6" IsParent="false" Name="Numero RUC" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[(select taxid from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" ColumnName="invoicedocumentno" GL_Book_ID="49679599-e513-60d3-b756-d58ec5491855" Identifier="47bce8b6-b62c-c0e7-da6d-ae6406a699cc" IsParent="false" Name="Numero" SeqNo="120" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="9d27ed06-c85c-763a-f4ba-5a27725b387d" IsParent="false" Name="Inconsistencia TC" SeqNo="320" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="a18db1ab-188d-4239-ac2e-12f835b549e1" Identifier="b1f5a89c-6cdc-46bf-bae4-705f107e57a4" IsParent="false" Name="CodigoProducto" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.valuep)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Identifier="0cce56e9-c13d-d791-968f-8948096a8bfa" IsParent="false" Name="Glosa Ref." SeqNo="170" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="25e25ea7-3f53-ea73-e1e9-f3706cd4e7ea" Identifier="f20b2592-dea6-433c-8f2c-a0a3b6dbe136" IsParent="false" Name="Saldo" SeqNo="40" IsActive="true">
        <ColumnSQL><![CDATA[round((sum($P{TABLE}.amtacctdr)-sum($P{TABLE}.amtacctcr)),2)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="f9fe6e66-3cb6-bf07-1470-f23f09d3bbcd" Identifier="d284ae70-34c7-909e-bcbf-14ec968a470a" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[COALESCE( min(case when left($P{TABLE}.fact_id,2)='14' then $P{TABLE}.fact_id  end ), min(case when left($P{TABLE}.fact_id,2)!='14' then $P{TABLE}.fact_id  end ))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="cd66e89c-0209-da87-3e45-c6fd1809b9b6" IsParent="false" Name="FechaVcto" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Identifier="7ab07b69-2327-45a2-acb8-56b306994c15" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}31'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="749397ba-37be-4ee7-96b0-e0f6970b86a4" IsParent="false" Name="tabla 32" SeqNo="340" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c139f038-aee3-1db9-4d86-6173c47fb74b" Identifier="ae869d4e-d1c6-1bed-3cda-5920a0b9aed9" IsParent="false" Name="Cod.Centro Costo" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="cf0f32ff-7a87-3587-264a-f1c1d07b8407" IsParent="false" Name="NroCorrelativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.fact_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="52b0d135-d58e-49b4-9f63-8531a98ffcd6" IsParent="false" Name="table 31" SeqNo="330" IsActive="true">
        <ColumnSQL><![CDATA['00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="12a42793-1fb0-459a-8ca8-748dddc84019" IsParent="false" SeqNo="280" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" AD_Reference_ID="3cefd939-fdfe-f99a-8105-07955b81a4cd" ColumnName="C_BPartner_ID" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="32c8ea04-c816-e411-25dc-46aa8b560e27" IsParent="false" Name="Cliente" SeqNo="120" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="a1a81289-2ed3-5ffd-f96e-0382fb926a4c" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="7f7d4d8d-6e82-a2ef-3c4e-b8401a00c4ac" IsParent="false" Name="AnioDUA" SeqNo="80" IsActive="true">
        <ColumnSQL><![CDATA[trim(to_char(extract(year from dateinvoiced),'9999'))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="e73b53f9-ce7c-a2f5-481b-932d035cb776" Identifier="f0472e7e-70c5-4825-94de-5a9475c9f35a" IsParent="false" Name="DocIdentidadSocio" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.valuebp)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="6871b03f-79fd-5689-a616-6e87649471e6" IsParent="false" Name="Moneda" SeqNo="240" IsActive="true">
        <ColumnSQL><![CDATA[(select iso_code from c_currency  where c_currency_id = $P{TABLE}.c_currency_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="78591f60-d78d-138f-eddd-4308115fc57b" IsParent="false" Name="IGV" SeqNo="160" IsActive="true">
        <ColumnSQL><![CDATA[(case when $P{TABLE}.docstatus = 'CO' then (round(gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'IGV'::text, 'IGV'::text),2)  ) else '0.00' end )]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="1fc6a6ea-59e7-5f46-c6c0-876e4eb10eaa" IsParent="false" Name="Campo29" SeqNo="290" IsActive="true">
        <ColumnSQL><![CDATA[''::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="619c1d5d-fed3-6203-3b32-6765a8120337" IsParent="false" Name="campo19" SeqNo="200" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="18988374-540c-c762-5c2f-87a085050605" Identifier="d104a7b9-d359-ac9d-74f2-1146fa6b3033" IsParent="false" Name="Correativo+tipo" SeqNo="30" IsActive="true">
        <ColumnSQL><![CDATA['M'||right((coalesce(min(case when amtacctdr > 0 then ($P{TABLE}.fact_id) end),min(case when amtacctcr > 0 then ($P{TABLE}.fact_id) end))),9)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Identifier="7d631d22-3c8b-ab53-43ee-41370dcdda84" IsParent="false" Name="Serie" SeqNo="70" IsActive="true">
        <ColumnSQL><![CDATA[lpad($P{TABLE}.serial,4,'0')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Identifier="f20a3a66-c138-d9e3-3aae-bd4af894c58c" IsParent="false" Name="Numero" SeqNo="120" IsActive="true">
        <ColumnSQL><![CDATA[(case when coalesce($P{TABLE}.c_doctype_id,00) = 00 then ($P{TABLE}.fact_acct_id::character varying) when  (select codsunat from c_doctype  where c_doctype_id = $P{TABLE}.c_doctype_id)= '00' then lpad($P{TABLE}.invoicedocumentno,20,' ') else lpad(( substring($P{TABLE}.invoicedocumentno,'(\d+)' )::numeric)::character varying,20,' ')  end)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="3380c1ef-bf28-db8f-e170-7cb59088558c" Identifier="e8b401db-f095-3e99-e58d-b3e07227e4a0" IsParent="false" Name="Inafecta" SeqNo="190" IsActive="true">
        <ColumnSQL><![CDATA[(case when $P{TABLE}.docstatus = 'CO' then (case when gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'NGR'::text, 'BASE'::text) > 0 then gettaxvalue( $P{TABLE}.c_doctype_id, $P{TABLE}.c_invoice_id, 'NGR'::text, 'BASE'::text) else '0.00' end) else '0.00' end )]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="8aa3c792-6bad-c926-94ba-5273be2c68fb" Identifier="81378a4f-2bb6-b979-4970-9129db746e5b" IsParent="false" Name="DocIdentidadSocio" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.taxid)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="c2ddb065-f45b-48e8-87e3-b6c267f94091" Identifier="c317b608-a117-46ae-ad87-4de28e34f617" IsParent="false" Name="NroCorrelativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.fact_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="d151a4f8-f1a9-9791-f7ed-b494310d4198" Identifier="9a69b59f-8ddd-0a06-d23d-3547dbe31c13" IsParent="false" Name="Periodo" SeqNo="10" IsActive="true">
        <ColumnSQL><![CDATA['$P{PERIOD}00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="3d08cde2-66c6-bac8-8a8f-4d30439f19d6" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="841a2f09-f4a7-ad5c-c41a-8c9612f5aaa2" IsParent="false" Name="TipRef" SeqNo="280" IsActive="true">
        <ColumnSQL><![CDATA[(SELECT codsunat from c_doctype where c_doctype_id in (SELECT c_doctype_id  from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id))]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="670b568f-d0dc-ae83-31c9-e60dbafbf676" Identifier="59dcb4e0-ee2b-4d7e-b38c-ca3b53ca550f" IsParent="false" Name="Correlativo" SeqNo="20" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.fact_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" C_DocType_ID="3d08cde2-66c6-bac8-8a8f-4d30439f19d6" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="fec3ce4c-e3c2-d71c-6fbb-c4a19b68faac" IsParent="false" Name="Total" SeqNo="240" IsActive="true">
        <ColumnSQL><![CDATA[CurrencyConvert($P{TABLE}.grandtotal,$P{TABLE}.C_Currency_ID, 308,(Select dateinvoiced from c_invoice iref where iref.c_invoice_id = $P{TABLE}.ref_invoice_id),$P{TABLE}.c_conversiontype_id,$P{TABLE}.AD_Client_ID, $P{TABLE}.AD_Org_ID) * (-1)::numeric]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="bfccf430-19ba-004d-dd83-52b96c8a3328" Identifier="5d80ca1d-72c1-2575-f857-c4896cf03ac9" IsParent="false" Name="Numero RUC" SeqNo="90" IsActive="true">
        <ColumnSQL><![CDATA[(select taxid from c_bpartner where c_bpartner_id = $P{TABLE}.c_bpartner_id)]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="5cef55d2-6b1e-bc02-15a2-328facae95c7" IsParent="false" Name="Tasa de Cambio" SeqNo="250" IsActive="true">
        <ColumnSQL><![CDATA[Case when $P{TABLE}.c_currency_id != 308 then round(currencyrate( $P{TABLE}.c_currency_id, 308,  $P{TABLE}.dateinvoiced,  $P{TABLE}.c_conversiontype_id,  $P{TABLE}.ad_client_id, 0),3) else '1.000' end]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="edf12cf9-cb73-15db-875d-0940811bbe94" Identifier="a4894478-283c-c59b-6f43-7c139997418c" IsParent="false" Name="campo18" SeqNo="180" IsActive="true">
        <ColumnSQL><![CDATA['0.00'::text]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="321bfd3e-d495-abb4-e788-d2128ee99669" Identifier="f3f31fcd-0e48-e127-177b-269f63da6a57" IsParent="false" Name="FechaVcto" SeqNo="50" IsActive="true">
        <ColumnSQL><![CDATA[to_char(dateacct,'DD/MM/YYYY')]]></ColumnSQL>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" GL_Book_ID="e73b53f9-ce7c-a2f5-481b-932d035cb776" Identifier="4d065311-c594-41b8-98c7-889ea78f7156" IsParent="false" Name="Nombre" SeqNo="60" IsActive="true">
        <ColumnSQL><![CDATA[($P{TABLE}.namebp)]]></ColumnSQL>
      </row>
    </table>
    <table name="GL_Book" accesslevel="0" level="2" Identifier="321bfd3e-d495-abb4-e788-d2128ee99669">
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="321bfd3e-d495-abb4-e788-d2128ee99669" Name="080100 - REGISTRO DE COMPRAS-PLE" Processed="false" ProcessingDate="dateacct" Value="080100" IsActive="false" />
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="fc00d860-d5a8-d88a-4b50-df9cb9fb589c" Name="060100 - LIBRO MAYOR-PLE" Processed="false" ProcessingDate="dateacct" Value="060100" IsActive="true">
        <WhereClause><![CDATA[(round(fact_acct.amtacctdr,2) - round(fact_acct.amtacctcr,2)) != 0]]></WhereClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="c240f167-8422-e009-279b-ffcf85fdaf77" Name="030900 - I&amp;
B Cta 34" Processed="false" ProcessingDate="dateacct" Value="030900" IsActive="true">
        <GroupByClause><![CDATA[valueacct, description]]></GroupByClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="bfccf430-19ba-004d-dd83-52b96c8a3328" Name="050100 - LIBRO DE DIARIO-PLE" Processed="false" ProcessingDate="dateacct" Value="050100" IsActive="true">
        <WhereClause><![CDATA[(round(fact_acct.amtacctdr,2) - round(fact_acct.amtacctcr,2)) != 0]]></WhereClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="c2e3cdd4-6c06-4ad2-90fd-87fc0f8a6cc4" Name="031500 - I&amp;B Cta 37 y 49" Processed="false" ProcessingDate="dateacct" Value="031500" IsActive="true">
        <GroupByClause><![CDATA[valueacct,taxid,serial,invoicedocumentno,description]]></GroupByClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="81bb7588-bd12-e2f9-0ba0-99f127585e99" Name="030700 - I&amp;B Cta 20 y 21" Processed="false" ProcessingDate="dateacct" Value="030700" IsActive="true">
        <GroupByClause><![CDATA[producttypetax, valuep, namep, um]]></GroupByClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="25e25ea7-3f53-ea73-e1e9-f3706cd4e7ea" Name="032000 - I&amp;B Resultados" Processed="false" ProcessingDate="dateacct" Value="032000" IsActive="true">
        <GroupByClause><![CDATA[taxid]]></GroupByClause>
        <OrderByClause><![CDATA[taxid]]></OrderByClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="d151a4f8-f1a9-9791-f7ed-b494310d4198" Name="010200 - LIBRO BANCOS" Processed="false" ProcessingDate="dateacct" Value="010200" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="f9fe6e66-3cb6-bf07-1470-f23f09d3bbcd" Name="030300 - I&amp;B Cta 12 y 13" Processed="false" ProcessingDate="dateacct" Value="030300" IsActive="true">
        <GroupByClause><![CDATA[taxid, namebp,taxtype]]></GroupByClause>
        <HavingClause><![CDATA[(SUM($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr)) <> 0]]></HavingClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="670b568f-d0dc-ae83-31c9-e60dbafbf676" Name="120100 - Inventario Unidades Fiscas" Processed="false" ProcessingDate="movementdate" Value="120100" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="1d81ccef-0699-4065-8898-b6263b549f33" Name="031602 - I&amp;B Participacion" Processed="false" ProcessingDate="created" Value="031602" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="8aa3c792-6bad-c926-94ba-5273be2c68fb" Name="031200 - I&amp;B Cta 42 y 43" Processed="false" ProcessingDate="dateacct" Value="031200" IsActive="true">
        <GroupByClause><![CDATA[taxtype,taxid,namebp]]></GroupByClause>
        <HavingClause><![CDATA[(SUM($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr)) <> 0]]></HavingClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="c188057d-9e63-d5a8-6c9e-fc760cd6d0d0" Name="06 - LIBRO MAYOR" Processed="false" ProcessingDate="dateacct" Value="06" IsActive="false">
        <WhereClause><![CDATA[(round(fact_acct.amtacctdr,2) - round(fact_acct.amtacctcr,2)) != 0]]></WhereClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="49679599-e513-60d3-b756-d58ec5491855" Name="05 - LIBRO DIARIO - PLE" Processed="false" ProcessingDate="dateacct" Value="05" IsActive="false">
        <WhereClause><![CDATA[(round(fact_acct.amtacctdr,2) - round(fact_acct.amtacctcr,2)) != 0]]></WhereClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="8d253def-98f6-8607-9ccf-483ed3a5ae31" Name="030600 - I&amp;B Cta 19" Processed="false" ProcessingDate="dateacct" Value="030600" IsActive="true">
        <GroupByClause><![CDATA[taxid, namebp, taxtype, codsunat, serial, invoicedocumentno]]></GroupByClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="c139f038-aee3-1db9-4d86-6173c47fb74b" Name="010100 - LIBRO CAJA" Processed="false" ProcessingDate="dateacct" Value="010100" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="a57b90d9-0301-e69f-8198-e190d883e100" Name="030500 - I&amp;B Cta 16 y 17" Processed="false" ProcessingDate="dateacct" Value="030500" IsActive="true">
        <GroupByClause><![CDATA[taxid,namebp,taxtype]]></GroupByClause>
        <HavingClause><![CDATA[(SUM($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr)) <> 0]]></HavingClause>
        <OrderByClause><![CDATA[namebp]]></OrderByClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="S" Identifier="edf12cf9-cb73-15db-875d-0940811bbe94" Name="14 - REGISTRO DE VENTAS E INGRESOS" Processed="false" ProcessingDate="dateacct" Value="14" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="2ac55dcb-50cc-c7c9-b91f-3dfd8eb5a5e6" Name="030200 - I&amp;B Cta 10" Processed="false" ProcessingDate="dateacct" Value="030200" IsActive="true">
        <GroupByClause><![CDATA[valueacct,banktax,accountno,currencytax]]></GroupByClause>
        <OrderByClause><![CDATA[valueacct]]></OrderByClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="1ebb8fbd-08ca-7d16-8c06-a54a0105456b" Name="080100 - REGISTRO DE COMPRAS - PLE" Processed="false" ProcessingDate="dateacct" Value="080100" IsActive="true">
        <WhereClause><![CDATA[(select  C_BP_Group_ID from c_bpartner where c_bpartner_id =($P{TABLE}.c_bpartner_id))  !=1004425]]></WhereClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="3380c1ef-bf28-db8f-e170-7cb59088558c" Name="140100 - REGISTRO DE VENTAS-PLE" Processed="false" ProcessingDate="dateacct" Value="140100" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="e73b53f9-ce7c-a2f5-481b-932d035cb776" Name="030800 - I&amp;B Cta 30" Processed="false" ProcessingDate="dateacct" Value="030800" IsActive="true">
        <GroupByClause><![CDATA[taxtype, valuebp, namebp]]></GroupByClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="5664a25e-e0c5-4158-b4f2-564c1ef4deb9" Name="050300 - LIBRO DIARIO DETALLE DEL PLAN DE CUENTAS" Processed="false" ProcessingDate="created" Value="050300" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="c2ddb065-f45b-48e8-87e3-b6c267f94091" Name="080200 - REGISTRO DE COMPRAS NO DOMICILIADOS" Processed="false" ProcessingDate="dateacct" Value="080200" IsActive="true">
        <WhereClause><![CDATA[(select  C_BP_Group_ID from c_bpartner where c_bpartner_id =($P{TABLE}.c_bpartner_id))  =1004425]]></WhereClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="41c8b837-12ba-0737-d7bb-404e4ec6b7de" Name="030100 - I&amp;B Balance" Processed="false" ProcessingDate="dateacct" Value="030100" IsActive="true">
        <GroupByClause><![CDATA[taxid]]></GroupByClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="b400dafa-3168-4101-8856-81f198d69749" Name="031601 - I&amp;
B Cta 50" Processed="false" ProcessingDate="dateacct" Value="031601" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="a18db1ab-188d-4239-ac2e-12f835b549e1" Name="130100 - Inventario Valorizado" Processed="false" ProcessingDate="movementdate" Value="130100" IsActive="true" />
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="c8ed8dca-c62a-6a45-9710-a013ab04f0f9" Name="031300 - I&amp;
B Cta 46 y 47" Processed="false" ProcessingDate="dateacct" Value="031300" IsActive="true">
        <GroupByClause><![CDATA[valueacct, taxtype, taxid, namebp]]></GroupByClause>
        <HavingClause><![CDATA[(SUM($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr)) <> 0]]></HavingClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="4c713835-45bb-29d8-84c1-42fe394b0eb3" Name="031100 - I&amp;B Cta 41" Processed="false" ProcessingDate="dateacct" Value="031100" IsActive="true">
        <GroupByClause><![CDATA[valueacct, taxtype, taxid, namebp, $P{TABLE}.user]]></GroupByClause>
        <HavingClause><![CDATA[(SUM($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr)) <> 0]]></HavingClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="8bfd103e-fbf6-cbfa-30b4-35fad1deb928" Name="031700 - I&amp;B Comprobacion" Processed="false" ProcessingDate="dateacct" Value="031700" IsActive="true">
        <GroupByClause><![CDATA[valueacct]]></GroupByClause>
        <OrderByClause><![CDATA[valueacct]]></OrderByClause>
      </row>
      <row AD_Client_ID="0" AD_Org_ID="0" BookType="P" Identifier="18988374-540c-c762-5c2f-87a085050605" Name="030400 - I&amp;B Cta 14" Processed="false" ProcessingDate="dateacct" Value="030400" IsActive="true">
        <GroupByClause><![CDATA[taxid,namebp,taxtype]]></GroupByClause>
        <HavingClause><![CDATA[(SUM($P{TABLE}.amtacctdr) - SUM($P{TABLE}.amtacctcr)) <> 0]]></HavingClause>
        <OrderByClause><![CDATA[namebp]]></OrderByClause>
      </row>
    </table>
    <table name="AD_Reference" accesslevel="0" level="2" Identifier="3cefd939-fdfe-f99a-8105-07955b81a4cd">
      <row AD_Client_ID="0" AD_Org_ID="0" Description="Direct Table Access" EntityType="D" Identifier="3cefd939-fdfe-f99a-8105-07955b81a4cd" IsOrderByValue="false" Name="Table Direct" ValidationType="D" IsActive="true" />
    </table>
  </record>
</stream>

